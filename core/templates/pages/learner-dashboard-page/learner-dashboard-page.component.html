<background-banner *ngIf="!windowIsNarrow || (windowIsNarrow && !isShowRedesignedLearnerDashboardActive && activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)"></background-banner>
<div [ngStyle]="{'min-height': windowIsNarrow ? '85.5vh': 'auto'}"
     class="position-relative" [ngClass]="{'oppia-learner-dash-container w-100' : isShowRedesignedLearnerDashboardActive(), 'oppia-learner-dashboard-container' : !isShowRedesignedLearnerDashboardActive()}">
  <div [ngStyle]="windowIsNarrow ? {'display': 'block'} : {'display': 'flex'}"
       [ngClass]="{'oppia-learner-dashboard-mobile-mode': windowIsNarrow, 'row oppia-row': !isShowRedesignedLearnerDashboardActive() ,'d-flex justify-content-center oppia-learner-dash-content': isShowRedesignedLearnerDashboardActive()}">
    <div class="col-md-3 oppia-learner-dashboard-side-content"
         *ngIf="!windowIsNarrow && !isShowRedesignedLearnerDashboardActive()">
      <mat-card class="oppia-learner-dashboard-main-menu">
        <h4 class="oppia-learner-dashboard-menu oppia-learner-dashborad-menu-hover e2e-test-home-section" tabindex="0"
            [ngClass]="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME}"
            (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)"
            (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME | translate"></span>
        </h4>
        <h4 class="oppia-learner-dashboard-menu oppia-learner-dashborad-menu-hover e2e-test-goals-section" tabindex="0"
            [ngClass]="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS}"
            (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS)"
            (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS)">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS | translate"></span>
        </h4>
        <h4 class="oppia-learner-dashboard-menu oppia-learner-dashborad-menu-hover e2e-test-progress-section" tabindex="0"
            [ngClass]="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS}"
            (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS)"
            (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS)" >
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS | translate"></span>
        </h4>
        <h4 class="oppia-learner-dashboard-menu oppia-learner-dashborad-menu-hover e2e-test-learner-groups-section" tabindex="0"
            [ngClass]="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS}"
            *ngIf="LEARNER_GROUP_FEATURE_IS_ENABLED"
            (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS)"
            (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS)" >
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS | translate"></span>
        </h4>
        <h4 class="oppia-learner-dashboard-menu oppia-learner-dashborad-menu-hover e2e-test-community-lessons-section" tabindex="0"
            [ngClass]="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMMUNITY_LESSONS}"
            (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMMUNITY_LESSONS)"
            (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMMUNITY_LESSONS)">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.COMMUNITY_LESSONS | translate"></span>
        </h4>
      </mat-card>
    </div>
    <nav class="align-items-center d-flex flex-md-column justify-content-center oppia-learner-dash-sidebar_position" role="navigation" *ngIf="isShowRedesignedLearnerDashboardActive()">
      <ol class="oppia-learner-dash-sidebar">
        <li class="oppia-learner-dash-sidebar_pic">
          <!--if want frame, div w/ "border border-2 border-white mb-5 rounded-circle oppia-learner-dash-sidebar_pic-frame" style-->
          <picture>
            <source type="image/webp" [srcset]="profilePictureWebpDataUrl" >
            <source type="image/png" [srcset]="profilePicturePngDataUrl" >
            <img alt="Profile image of user" class="mb-5" height="72px" [src]="profilePicturePngDataUrl" width="72px" >
          </picture>
        </li>
        <li>
          <button class="align-items-center d-inline-flex e2e-test-home-section rounded oppia-learner-dash-sidebar_btn text-left w-100" tabindex="0"
                  [ngClass]="{'oppia-learner-dash-sidebar_btn--active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME}"
                  (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)"
                  (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)">
            <span class="fas fa-home fa-lg"></span>
            {{ LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME | translate }}
          </button>
        </li>
        <li>
          <button class="align-items-center d-inline-flex e2e-test-goals-section rounded oppia-learner-dash-sidebar_btn text-left w-100" tabindex="0"
                  [ngClass]="{'oppia-learner-dash-sidebar_btn--active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS}"
                  (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS)"
                  (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS)">
            <span class="fas fa-bullseye fa-lg"></span>
            {{ LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS | translate }}
          </button>
        </li>
        <li>
          <button class="align-items-center d-inline-flex e2e-test-progress-section rounded oppia-learner-dash-sidebar_btn text-left w-100" tabindex="0"
                  [ngClass]="{'oppia-learner-dash-sidebar_btn--active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS}"
                  (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS)"
                  (keyup.enter)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS)">
            <span class="fas fa-chart-line fa-lg"></span>
            {{ LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS | translate }}
          </button>
        </li>
      </ol>
    </nav>
    <footer class="oppia-learner-dashboard-buttons" *ngIf="windowIsNarrow && !isShowRedesignedLearnerDashboardActive()" headroom>
      <mat-card class="oppia-learner-dashboard-button-menu d-flex justify-content-around">
        <div class="oppia-buttons" (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME)" [ngClass]="{'oppia-learner-dashboard-section-active-button': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME, 'oppia-learner-dashboard-section-not-active-button': activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME}">
          <img [src]="homeImageUrl" alt="home image" class="oppia-svg-image">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME | translate" class="home-button"></span>
        </div>
        <div class="oppia-buttons" (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS)" [ngClass]="{'oppia-learner-dashboard-section-active-button': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS, 'oppia-learner-dashboard-section-not-active-button': activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS}">
          <img [src]="todolistImageUrl" alt="todolist image" class="oppia-svg-image">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS | translate" class="goals-button"></span>
        </div>
        <div class="oppia-buttons" (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS)" [ngClass]="{'oppia-learner-dashboard-section-active-button': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS, 'oppia-learner-dashboard-section-not-active-button': activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS}">
          <img [src]="progressImageUrl" alt="progress image" class="oppia-svg-image">
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS | translate" class="progress-button"></span>
        </div>
        <div class="oppia-buttons" *ngIf="LEARNER_GROUP_FEATURE_IS_ENABLED" (click)="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS)" [ngClass]="{'oppia-learner-dashboard-section-active-button': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS, 'oppia-learner-dashboard-section-not-active-button': activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS}">
          <i class="fa fa-users learner-groups-icon" aria-hidden="true"></i>
          <span [innerHTML]="LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS | translate" class="learner-groups-button"></span>
        </div>
      </mat-card>
    </footer>
    <div *ngIf="windowIsNarrow && activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS">
      <mat-card class="oppia-learner-dashboard-progress-button-menu d-flex justify-content-around">
        <div class="oppia-learner-dashboard-progress-button-menu-options" [ngStyle]="activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.SKILL_PROFICIENCY && {'border-bottom': '2px solid #00645C'}" (click)="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.SKILL_PROFICIENCY)">
          <p [innerHTML]="'I18N_DASHBOARD_SKILL_PROFICIENCY' | translate">
          </p>
        </div>
        <div class="oppia-learner-dashboard-progress-button-menu-options" [ngStyle]="activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.STORIES && {'border-bottom': '2px solid #00645C'}" (click)="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.STORIES)">
          <p [innerHTML]="'I18N_DASHBOARD_STORIES' | translate">
          </p>
        </div>
        <div class="oppia-learner-dashboard-progress-button-menu-options" [ngStyle]="activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.LESSONS && {'border-bottom': '2px solid #00645C'}" (click)="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.LESSONS)">
          <p [innerHTML]="'I18N_DASHBOARD_LESSONS' | translate">
          </p>
        </div>
      </mat-card>
    </div>
    <div [ngClass]="{'oppia-learner-dashboard-mobile-mode': windowIsNarrow, 'oppia-learner-dashboard-main-content col-md-8' : !isShowRedesignedLearnerDashboardActive(), 'oppia-learner-dash-tab overflow-hidden ml-md-4 px-4 px-md-0' : isShowRedesignedLearnerDashboardActive() }">
      <div class="d-flex w-100"
           [ngClass]="{'oppia-learner-dashboard-main-content-container pl-5': !windowIsNarrow && !isShowRedesignedLearnerDashboardActive(), 'justify-content-center': windowIsNarrow}">
        <div class="w-100" *ngIf="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.HOME">
          <oppia-home-tab [currentGoals]="topicsToLearn"
                          [redesignFeatureFlag]="isShowRedesignedLearnerDashboardActive()"
                          [goalTopics]="allTopics"
                          [incompleteCollectionsList]="incompleteCollectionsList"
                          [incompleteExplorationsList]="incompleteExplorationsList"
                          [partiallyLearntTopicsList]="partiallyLearntTopicsList"
                          [untrackedTopics]="untrackedTopics"
                          [username]="username"
                          (setActiveSection)="setActiveSection($event)">
          </oppia-home-tab>
        </div>
        <div *ngIf="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.GOALS">
          <oppia-goals-tab [currentGoals]="topicsToLearn"
                           [editGoals]="allTopics"
                           [completedGoals]="learntTopicsList"
                           [untrackedTopics]="untrackedTopics"
                           [partiallyLearntTopicsList]="partiallyLearntTopicsList"
                           [learntToPartiallyLearntTopics]="learntToPartiallyLearntTopics">
          </oppia-goals-tab>
        </div>
        <div *ngIf="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS && !windowIsNarrow">
          <oppia-progress-tab [completedStoriesList]="completedStoriesList"
                              [partiallyLearntTopicsList]="partiallyLearntTopicsList"
                              [learntTopicsList]="learntTopicsList"
                              (setActiveSection)="setActiveSection($event)">
          </oppia-progress-tab>
        </div>
        <div *ngIf="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS && windowIsNarrow">
          <oppia-progress-tab [completedStoriesList]="completedStoriesList"
                              [partiallyLearntTopicsList]="partiallyLearntTopicsList"
                              [learntTopicsList]="learntTopicsList"
                              [activeSubsection]="activeSubsection"
                              (setActiveSection)="setActiveSection($event)">
          </oppia-progress-tab>
        </div>
        <div *ngIf="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.LEARNER_GROUPS && LEARNER_GROUP_FEATURE_IS_ENABLED">
          <oppia-learner-groups-tab [username]="username"
                                    (setActiveSection)="setActiveSection($event)">
          </oppia-learner-groups-tab>
        </div>
        <div *ngIf="((!windowIsNarrow && activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMMUNITY_LESSONS) || (windowIsNarrow && activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PROGRESS && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.LESSONS)) && communityLessonsDataLoaded">
          <oppia-community-lessons-tab [incompleteExplorationsList]="incompleteExplorationsList"
                                       [incompleteCollectionsList]="incompleteCollectionsList"
                                       [completedExplorationsList]="completedExplorationsList"
                                       [completedCollectionsList]="completedCollectionsList"
                                       [explorationPlaylist]="explorationPlaylist"
                                       [collectionPlaylist]="collectionPlaylist"
                                       [subscriptionsList]="subscriptionsList"
                                       [completedToIncompleteCollections]="completedToIncompleteCollections">
          </oppia-community-lessons-tab>
        </div>
      </div>
    </div>

    <div class="col-md-2 oppia-learner-dashboard-side-content"
         [ngClass]="{'oppia-learner-dashboard-mobile-mode': windowIsNarrow}"
         *ngIf="!isShowRedesignedLearnerDashboardActive()" >
    </div>
  </div>
</div>

<style>
  .oppia-profile-alignment {
    vertical-align: middle;
  }
  .oppia-box-size {
    padding: 2px 10px;
  }
</style>
