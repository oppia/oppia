{% extends "base.html" %}

<!-- Gallery page is a special case: we switch the main and sub titles -->
{% block maintitle %}
  Gallery
{% endblock maintitle %}

{% block subtitle %}
  Oppia
{% endblock subtitle %}

{% block navbar_breadcrumb %}
{% endblock navbar_breadcrumb %}

{% block local_top_nav_options %}
  <search-bar></search-bar>
{% endblock %}

{% block base_url %}
  <base href="/search/">
{% endblock %}

{% block header_js %}
  {{ super() }}
  <script type="text/javascript">
    GLOBALS.LANGUAGE_CODES_AND_NAMES = JSON.parse(
      '{{LANGUAGE_CODES_AND_NAMES|js_string}}');
    GLOBALS.GALLERY_CATEGORY_FEATURED_EXPLORATIONS = JSON.parse(
      '{{GALLERY_CATEGORY_FEATURED_EXPLORATIONS|js_string}}');
  </script>

  <style>
    html, body {
      background-color: #eee;
    }
  </style>
{% endblock header_js %}

{% block content %}
  <div ng-controller="Gallery" class="oppia-gallery-container">
    <div style="position: relative; z-index: 3;">
      <div class="oppia-gallery-tiles-area" ng-if="!inSearchMode">
        <div class="oppia-gallery-tiles-container">
          <div ng-if="galleryGroups.length === 0"
               style="margin: 150px auto; text-align: center; width: 100%;">
            There are no groups of explorations available to display.
          </div>

          <div class="oppia-gallery-group" ng-repeat="galleryGroup in galleryGroups track by $index">
            <hr ng-if="$index !== 0 && galleryGroups[$index - 1].header === GALLERY_CATEGORY_FEATURED_EXPLORATIONS"
                class="oppia-gallery-featured-explorations-separator">

            <div>
              <h2 class="oppia-gallery-group-header">
                <a ng-click="showFullGalleryGroup(galleryGroup)">
                  <[galleryGroup.header]>
                </a>
              </h2>
            </div>

            <div>
              <!-- TODO(sll): Add card at end of the row that, when clicked, does showFullGalleryGroup(galleryGroup)" -->
              <md-button class="md-no-ink oppia-gallery-scroll-btn"
                         ng-click="scroll($index, true)"
                         ng-hide="leftmostCardIndices[$index] == 0">
                <i class="material-icons">keyboard_arrow_left</i>
              </md-button>
              <div class="oppia-gallery-scroll-btn" ng-if="leftmostCardIndices[$index] == 0"></div>

              <div class="oppia-gallery-tiles-carousel"
                   ng-swipe-right="scroll($index, true)"
                   ng-swipe-left="scroll($index, false)">
                <div class="oppia-gallery-tiles-carousel-overlay-left"></div>
                <div class="oppia-gallery-tiles">
                  <exploration-summary-tile ng-repeat="tile in galleryGroup.activity_summary_dicts"
                                            exploration-id="tile.id"
                                            exploration-title="tile.title"
                                            last-updated-msec="tile.last_updated_msec"
                                            objective="tile.objective"
                                            category="tile.category"
                                            ratings="tile.ratings"
                                            num-views="tile.num_views"
                                            thumbnail-icon-url="tile.thumbnail_icon_url"
                                            thumbnail-bg-color="tile.thumbnail_bg_color"
                                            class="protractor-test-gallery-tile">
                  </exploration-summary-tile>
                </div>
                <div class="oppia-gallery-tiles-carousel-overlay-right"></div>
              </div>

              <md-button class="md-no-ink oppia-gallery-scroll-btn"
                         ng-click="scroll($index, false)"
                         ng-hide="(galleryGroup.activity_summary_dicts.length - tileDisplayCount) <= leftmostCardIndices[$index]">
                <i class="material-icons">keyboard_arrow_right</i>
              </md-button>
              <div class="oppia-gallery-scroll-btn" ng-if="(galleryGroup.activity_summary_dicts.length - tileDisplayCount) <= leftmostCardIndices[$index]"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="oppia-gallery-tiles-area" ng-if="inSearchMode">
        <search-results></search-results>
      </div>
    </div>
  </div>

  {% include 'components/circular_image_directive.html' %}
  {% include 'components/profile_link_image_directive.html' %}
  {% include 'components/search_bar_directive.html' %}
  {% include 'components/search_results_directive.html' %}
{% endblock %}

{% block footer_js %}
  {{ super() }}
  <script>
    {{ include_js_file('components/CircularImageDirective.js') }}
    {{ include_js_file('components/ProfileLinkImageDirective.js') }}
    {{ include_js_file('components/SearchBarDirective.js') }}
    {{ include_js_file('components/SearchResultsDirective.js') }}

    {{ include_js_file('galleries/Gallery.js') }}
  </script>
{% endblock footer_js %}
