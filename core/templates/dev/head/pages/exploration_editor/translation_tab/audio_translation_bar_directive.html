<div  class="oppia-drop-area" ng-if="showDropArea">
  <div class="oppia-blur-background"></div>
  <div class="oppia-drop-area-message">Drop your file here!</div>
</div>
<div class="oppia-audio-recording-bar" ng-show="(!isAudioAvailable || audioIsUpdating) && !selectedRecording">
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button" disabled>
      <i class="material-icons">play_arrow</i>
    </button>
  </div>
  <div class="oppia-content-wrapper oppia-audio-bar-info">
    <div ng-if="!cannotRecord && !checkingMicrophonePermission">
      No audio recorded.<span ng-if="canTranslate"> Press <i class="material-icons">mic</i>  to start recording.</span>
    </div>
    <div ng-if="checkingMicrophonePermission">
      Loading microphone.<loading-dots></loading-dots>
    </div>
    <div ng-if="recordingPermissionDenied && cannotRecord">
      You need to grant permission for this application to use your microphone.
    </div>
    <div ng-if="unsupportedBrowser && cannotRecord">
      Sorry, your browser does not support recording feature.
    </div>
  </div>
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button"
            uib-tooltip="Record"
            tooltip-placement="above"
            ng-click="checkAndStartRecording()"
            ng-disabled="!canTranslate || cannotRecord">
      <i class="material-icons">&#xE029;</i>
    </button>
  </div>
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button"
            uib-tooltip="Upload"
            tooltip-placement="above"
            ng-click="openAddAudioTranslationModal()"
            ng-disabled="!canTranslate">
      <i class="material-icons">&#xE2C6;</i>
    </button>
  </div>
</div>
<div class="oppia-audio-recording-bar" ng-show="selectedRecording  && !audioIsCurrentlyBeingSaved">
  <ng-audio-recorder id="<[RECORDER_ID]>"
                     on-record-start="onRecordStart()"
                     on-conversion-complete="onConversionComplete()"
                     audio-model="audioBlob"
                     time-limit="recordingTimeLimit">
    <div class="oppia-content-wrapper">
      <button class="btn oppia-audio-button"
              ng-click="recorder.status.isPlaying ? recorder.playbackPause() : recorder.playbackResume()"
              ng-disabled="recorder.status.isRecording || !recorder.audioModel">
        <i class="material-icons">
          {{recorder.status.isStopped || recorder.status.isPaused ? 'play_arrow' : 'pause']>
        </i>
      </button>
    </div>
    <div class="oppia-content-wrapper oppia-flex-1-wrapper">
      <div class="oppia-audio-visualiser">
        <div class="oppia-mp3-converting" ng-if="recorder.status.isConverting">
          Converting to mp3<loading-dots></loading-dots>
        </div>
        <canvas-sizer id="analyser">
          <div class="oppia-recoding-analyzer" ng-show="recorder.isHtml5 && recorder.status.isRecording && !audioIsCurrentlyBeingSaved">
            <ng-audio-recorder-analyzer height="92" wave-color="black" ></ng-audio-recorder-analyzer>
          </div>
          <div class="oppia-audio-wave-view" ng-show="!recorder.status.isRecording && recorder.audioModel && !audioIsCurrentlyBeingSaved">
            <ng-audio-recorder-wave-view wave-color="#009688" progress-color="#ccc" height="38"></ng-audio-recorder-wave-view>
          </div>
        </canvas-sizer>
      </div>
    </div>
    <div class="oppia-content-wrapper" ng-if="recorder.status.isRecording">
      <div class="oppia-recording-timer">
        <[recorder.elapsedTime | formatTimer]> / <[recorder.timeLimit | formatTimer]>
      </div>
    </div>
    <div class="oppia-content-wrapper" ng-if="recorder.status.isRecording">
      <button class="btn oppia-audio-button"
              uib-tooltip="Stop"
              tooltip-placement="above"
              ng-click="recorder.stopRecord()">
        <i class="material-icons">stop</i>
      </button>
    </div>
  </ng-audio-recorder>
  <div class="oppia-content-wrapper" ng-if="!recorder.status.isRecording && audioBlob">
    <button class="btn oppia-confirm-button"
            ng-click="saveRecordedAudio()">
      Confirm
    </button>
  </div>
  <div class="oppia-content-wrapper" ng-if="!recorder.status.isRecording && audioBlob">
    <button class="btn oppia-cancel-button"
            ng-click="cancelRecording()">
      Cancel
    </button>
  </div>
</div>
<div class="oppia-audio-recording-bar" ng-if="audioIsCurrentlyBeingSaved">
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button" disabled>
      <i class="material-icons">play_arrow</i>
    </button>
  </div>
  <div class="oppia-content-wrapper oppia-flex-1-wrapper">
    <div class="oppia-audio-bar-info">
      <div>Saving<loading-dots></loading-dots></div>
    </div>
  </div>
</div>
<div ng-if="isAudioAvailable && !audioIsUpdating" class="oppia-audio-recording-bar">
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button"
            ng-click="playPauseUploadedAudioTranslation()">
      <i class="material-icons"><[isPlayingUploadedAudio() ? 'pause' : 'play_arrow']></i>
    </button>
  </div>
  <div class="oppia-slider-section oppia-content-wrapper">
    <div ng-if="audioLoadingIndicatorIsShown">
      <md-progress-linear md-mode="indeterminate"></md-progress-linear>
    </div>
    <div ng-if="!audioLoadingIndicatorIsShown">
      <md-slider ng-model="track.progress" ng-model-options="{getterSetter: true}" aria-label="audio-slider">
      </md-slider>
    </div>
  </div>
  <div class="oppia-content-wrapper oppia-recording-timer">
    <div ng-if="showAudioTimer">
      <[getUploadedAudioTimer()]>
    </div>
  </div>
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button"
            uib-tooltip="Upload audio"
            tooltip-placement="above"
            ng-disabled="!canTranslate"
            ng-click="openAddAudioTranslationModal()">
      <i class="material-icons">&#xE2C6;</i>
    </button>
  </div>
  <div class="oppia-content-wrapper">
    <button class="btn oppia-audio-button"
            uib-tooltip="Delete"
            tooltip-placement="above"
            ng-disabled="!canTranslate"
            ng-click="openDeleteAudioTranslationModal()">
      <i class="material-icons">&#xE872;</i>
    </button>
  </div>
  <div class="oppia-content-wrapper" ng-if="!audioNeedsUpdate">
    <button class="btn oppia-audio-button"
            uib-tooltip="Mark need update"
            tooltip-placement="above"
            ng-disabled="!canTranslate"
            ng-click="toggleAudioNeedsUpdate()">
      <i class="material-icons">warning</i>
    </button>
  </div>
  <div class="oppia-content-wrapper" ng-if="audioNeedsUpdate">
    <button class="btn oppia-audio-button"
            uib-tooltip="Unmark need update"
            tooltip-placement="above"
            ng-disabled="!canTranslate"
            ng-click="toggleAudioNeedsUpdate()">
      <i class="material-icons">warning</i>
      <i class="material-icons oppia-unmark-icon">clear</i>
    </button>
  </div>
</div>
<div class="oppia-translation-bottom-right-container" ng-if="showRecorderWarning">
  <span>
    <strong>Warning: </strong>Don't navigate to other tabs of this page before saving recorded audio, otherwise the recorded audio will be lost.
  </span>
</div>
<style>
  .oppia-drop-area {
    border: 3px dashed #aaa;
    height: 80%;
    position: absolute;
    top: 10%;
    width: 100%;
    z-index: 100;
  }
  .oppia-blur-background {
    background-color: #fff;
    height: 100%;
    opacity: 0.8;
    position: absolute;
    width: 100%;
  }
  .oppia-drop-area-message {
    font-size: 36px;
    height: 100%;
    padding: 20%;
    position: absolute;
    text-align: center;
    width: 100%;
  }
  .oppia-audio-recording-bar {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    padding: 0px 10px;
    background-color: #f7f7f7;
  }
  .audioRecorder {
    display: flex;
    align-items: center;
  }
  .audioRecorder > div:first-child {
    width: 0 !important;
  }
  .oppia-content-wrapper {
    margin: 0 10px;
  }
  .oppia-audio-bar-info {
    background-color: #6f6f6f;
    color: white;
    padding: 5px 40px;
    border-radius: 3px;
    flex: 1;
    text-align: center;
    font-size: 12px;
    height: 38px;
    line-height: 27px;
  }
  .oppia-audio-button {
    color: white;
    background-color: #009688;
    border-radius: 20px;
    width: 38px;
    padding-left: 6px;
    transition: background-color .2s cubic-bezier(.35,0,.25,1);
  }
  .oppia-confirm-button {
    color: white;
    background-color: #009688;
    width: 63px;
    border-radius: 3px;
    padding-left: 6px;
    transition: background-color .2s cubic-bezier(.35,0,.25,1);
  }
  .oppia-cancel-button {
    color: white;
    background-color: #9a9a9a;
    width: 57px;
    border-radius: 3px;
    padding-left: 6px;
    transition: background-color .2s cubic-bezier(.35,0,.25,1);
  }
  .oppia-audio-button:hover, .oppia-confirm-button:hover {
    color: white;
    background-color: #01675d;
  }
  .oppia-cancel-button:hover {
    color: white;
    background-color: #858585;
  }
  .oppia-audio-button[disabled] {
    background-color: #9a9a9a;
    pointer-events: auto;
  }
  .oppia-audio-button:focus {
    color: white;
  }
  .oppia-audio-visualiser {
    flex: 1;
    height: 38px;
  }
  .oppia-flex-1-wrapper {
    flex: 1;
  }
  .oppia-mp3-converting {
    background-color: #6f6f6f;
    color: white;
    padding: 5px 40px;
    border-radius: 3px;
    flex: 1;
    text-align: center;
    font-size: 12px;
    height: 38px;
    line-height: 27px;
  }
  .oppia-recording-timer {
    font-size: 14px;
    width: 83px;
    text-align: center;
  }
  .oppia-slider-section {
    flex: 1;
    background-color: #6f6f6f;
    color: white;
    padding: 0 15px;
    border-radius: 3px;
    text-align: center;
    font-size: 12px;
    height: 38px;
  }
  .oppia-translation-bottom-right-container {
    position: relative;
    top: 10px;
    text-align: center;
    font-size: 12px;
    color: #ce133b;
    letter-spacing: 0.5px;
  }
  .oppia-unmark-icon {
    color: #fff;
    font-size: 13px;
    margin-top: -25px;
    margin-left: -5px;
    background-color: #7a7a7a;
    border-radius: 25px;
    font-weight: bold;
    border: 1px solid #fff;
  }
  ng-audio-recorder {
    width: 100%;
  }
  audio-translation-bar md-progress-linear {
    padding-top: 12px;
    height: 38px;
  }
  audio-translation-bar md-progress-linear.md-default-theme .md-container {
    background-color: #f8f8f8;
  }
  audio-translation-bar md-progress-linear.md-default-theme .md-bar {
    background-color: #009688;
  }
  audio-translation-bar md-slider .md-thumb-container {
    left: 4px;
  }
  audio-translation-bar md-slider {
    height: 38px;
  }
  audio-translation-bar md-slider .md-track-container {
    top: 18px !important;
    height: 1px;
  }
  audio-translation-bar md-slider .md-track {
    background-color: #f8f8f8;
  }
  audio-translation-bar md-slider.md-default-theme .md-track-fill {
    background-color: #009688;
  }
  audio-translation-bar md-slider .md-thumb {
    top: 0;
  }
  audio-translation-bar md-slider.md-default-theme .md-thumb:after {
    border-color: #ccc;
    background-color: #009688;
  }
  audio-translation-bar canvas {
    background: #e4e1d1;
    max-width: unset;
    border-radius: 3px;
  }
  audio-translation-bar .waveSurfer > wave:first-child {
    border-radius: 3px;
  }
</style>
