{% extends 'pages/base.html' %}

{% block maintitle %}
  Learner Dashboard - Oppia
{% endblock maintitle %}

{% block navbar_breadcrumb %}
  <ul class="nav navbar-nav oppia-navbar-breadcrumb">
    <li>
      <span class="oppia-navbar-breadcrumb-separator"></span>
      <span translate="I18N_TOPNAV_LEARNER_DASHBOARD"></span>
    </li>
  </ul>
{% endblock navbar_breadcrumb %}

{% block content %}
  <background-banner></background-banner>
  <div class="oppia-learner-dashboard-container" ng-controller="LearnerDashboard" style="position: relative;">
    <div>
      <h2 class="oppia-learner-dashboard-title"
          translate="I18N_TOPNAV_LEARNER_DASHBOARD"
          ng-class="{'oppia-learner-dashboard-title-mobile': checkMobileView()}">
      </h2>
    </div>

    <div class="oppia-dashboard-aggregated-stats oppia-learner-dashboard-main-content"
         style="padding-top: 10px; margin: auto;"
         ng-class="{'oppia-learner-dashboard-mobile-mode': checkMobileView()}"
         ng-if="!noActivity">
      <md-card layout="row"
               ng-style="checkMobileView() ? {'margin-bottom': '10px'} : {'margin-bottom': '40px'}">
        <div class="stats-card">
          <p class="stat-description">Completed Explorations</p>
          <h1 class="stat-value"><[completedExplorationsList.length]></h1>
        </div>
        <div class="stats-card">
          <p class="stat-description">Completed Collections</p>
          <h1 class="stat-value"><[completedCollectionsList.length]></h1>
        </div>
        <div class="stats-card">
          <p class="stat-description">Subscriptions</p>
          <h1 class="stat-value"><[subscriptionsList.length]></h1>
        </div>
      </md-card>
    </div>

    <div class="row"
         ng-style="checkMobileView() ? {'display': 'block'} : {'display': 'flex'}"
         style="display: flex;"
         ng-if="noActivity">
      <div class="col-sm-2"
           ng-style="checkMobileView() ? {'text-align': 'center'} : {'text-align': 'left'}">
        <div style="height: 100%;" ng-if="!checkMobileView()"></div>
        <img ng-src="<[getStaticImageUrl('/general/collection_mascot.svg')]>"
             ng-class="{'oppia-learner-dashboard-mascot-mobile': checkMobileView()}"
             class="oppia-learner-dashboard-mascot">
      </div>

      <div class="col-sm-8">
        <blockquote class="oppia-learner-dashboard-intro-card">
          <p class="oppia-learner-dashboard-intro-card-message" style="padding-top: 6px;"
             translate="I18N_LEARNER_DASHBOARD_INTRO_MESSAGE_PART_ONE">
          </p>
          <p class="oppia-learner-dashboard-intro-card-message" style="padding-top: 15px;"
             translate="I18N_LEARNER_DASHBOARD_INTRO_MESSAGE_PART_TWO">
          </p>
          <a class="btn oppia-learner-dashboard-intro-button oppia-transition-200"
             translate="I18N_ACTION_BROWSE_LESSONS"
             ng-href="/library">
          </a>
        </blockquote>
      </div>

      <div class="col-sm-2">

      </div>
    </div>

    <div class="row"
         ng-style="checkMobileView() ? {'display': 'block'} : {'display': 'flex'}"
         ng-class="{'oppia-learner-dashboard-mobile-mode': checkMobileView()}"
         style="display: flex;"
         ng-if="!noActivity">
      <div class="col-md-2 oppia-learner-dashboard-side-content"
           ng-class="{'oppia-learner-dashboard-mobile-mode': checkMobileView()}"
           style="min-width: 200px;">
        <md-card class="oppia-learner-dashboard-main-menu">
          <h4 class="oppia-learner-dashboard-menu"
              ng-class="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST}"
              ng-click="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST)">
            <span translate="<[LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST]>"></span>
            <span class="caret"></span>
          </h4>
          <div ng-show="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST" class="menu-sub-section">
            <div class="oppia-learner-dashboard-submenu"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)"
                 translate="I18N_DASHBOARD_EXPLORATIONS">
            </div>
            <div class="oppia-learner-dashboard-submenu protractor-test-playlist-collection-section"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)"
                 translate="I18N_DASHBOARD_COLLECTIONS">
            </div>
          </div>
          <h4 class="oppia-learner-dashboard-menu"
              ng-class="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE}"
              ng-click="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE)">
            <span translate="<[LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE]>"></span>
            <span class="caret"></span>
          </h4>
          <div ng-show="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE" class="menu-sub-section">
            <div class="oppia-learner-dashboard-submenu"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)"
                 translate="I18N_DASHBOARD_EXPLORATIONS">
            </div>
            <div class="oppia-learner-dashboard-submenu protractor-test-incomplete-collection-section"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)"
                 translate="I18N_DASHBOARD_COLLECTIONS">
            </div>
          </div>
          <h4 class="oppia-learner-dashboard-menu protractor-test-completed-section"
              ng-class="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED}"
              ng-click="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED)">
            <span translate="<[LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED]>"></span>
            <span class="caret"></span>
          </h4>
          <div ng-show="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED" class="menu-sub-section">
            <div class="oppia-learner-dashboard-submenu"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)"
                 translate="I18N_DASHBOARD_EXPLORATIONS">
            </div>
            <div class="oppia-learner-dashboard-submenu protractor-test-completed-collection-section"
                 ng-class="{'oppia-learner-dashboard-sub-section-active': activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS}"
                 ng-click="setActiveSubsection(LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)"
                 translate="I18N_DASHBOARD_COLLECTIONS">
            </div>
          </div>
          <h4 class="oppia-learner-dashboard-menu protractor-test-subscriptions-section"
              ng-class="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS}"
              ng-click="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS)">
            <span translate="<[LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS]>"></span>
          </h4>
          <h4 class="oppia-learner-dashboard-menu protractor-test-feedback-section"
              ng-class="{'oppia-learner-dashboard-section-active': activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK}"
              ng-click="setActiveSection(LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK)">
            <span translate="<[LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK]>"></span>
            <span ng-if="numberOfUnreadThreads !== 0">(<[numberOfUnreadThreads]>)</span>
          </h4>
        </md-card>
      </div>

      <div class="col-md-8 oppia-learner-dashboard-main-content"
           ng-class="{'oppia-learner-dashboard-mobile-mode': checkMobileView()}">
        <div>
          <span class="oppia-learner-dashboard-main-content-title">
            <span translate="<[activeSection]>"></span>
            <span ng-if="activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS && activeSection !== LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK">
              <span class="oppia-navbar-breadcrumb-separator"
                    style="margin: 0 1px;">
              </span>
              <span translate="<[activeSubsection]>"></span>
            </span>
          </span>

          <span class="sort-explorations-select oppia-learner-dashboard-sort"
                ng-class="{'oppia-learner-dashboard-sort-mobile': checkMobileView()}"
                ng-if="activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS && ((activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED && completedExplorationsList.length !== 0) || (activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE && incompleteExplorationsList.length !== 0))">
            <p class="sort-by-text" style="margin-top: 0;">Sort By</p>
            <select ng-model="currentExpSortType"
                    class="sort-options"
                    style="margin-top: 0;"
                    ng-change="setExplorationsSortingOptions(currentExpSortType)"
                    ng-options="value['key'] as value['i18nId'] | translate for (key, value) in EXPLORATIONS_SORT_BY_KEYS_AND_I18N_IDS">
            </select>
            <span class="sort-order fa"
                  ng-click="setExplorationsSortingOptions(currentExpSortType)"
                  ng-class="isCurrentExpSortDescending ? 'fa-long-arrow-down':'fa-long-arrow-up'">
            </span>
          </span>

          <span class="sort-explorations-select oppia-learner-dashboard-sort"
                ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS && subscriptionsList.length !== 0"
                ng-class="{'oppia-learner-dashboard-sort-mobile': checkMobileView()}"
                style="margin-bottom: 7px;">
            <p class="sort-by-text" style="margin-top: 0;">Sort By</p>
            <select ng-model="currentSubscribersSortType"
                    class="sort-options"
                    ng-change="setSubscriptionSortingOptions(currentSubscribersSortType)"
                    ng-options="value['key'] as value['i18nId'] | translate for (key, value) in SUBSCRIPTION_SORT_BY_KEYS_AND_I18N_IDS"
                    style="width: 160px;">
            </select>
            <span class="sort-order fa"
                  ng-click="setSubscriptionSortingOptions(currentSubscribersSortType)"
                  ng-class="isCurrentSubscriptionSortDescending ? 'fa-long-arrow-down':'fa-long-arrow-up'">
            </span>
          </span>

          <span class="sort-explorations-select oppia-learner-dashboard-sort"
                ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK && threadSummaries.length !== 0 && !feedbackThreadActive"
                ng-class="{'oppia-learner-dashboard-sort-mobile': checkMobileView()}"
                style="margin-bottom: 7px;">
            <p class="sort-by-text" style="margin-top: 0;">Sort By</p>
            <select ng-model="currentFeedbackThreadsSortType"
                    class="sort-options"
                    ng-change="setFeedbackSortingOptions(currentFeedbackThreadsSortType)"
                    ng-options="value['key'] as value['i18nId']| translate for (key, value) in FEEDBACK_THREADS_SORT_BY_KEYS_AND_I18N_IDS"
                    style="width: 160px;">
            </select>
            <span class="sort-order fa"
                  ng-click="setFeedbackSortingOptions(currentFeedbackThreadsSortType)"
                  ng-class="isCurrentFeedbackSortDescending ? 'fa-long-arrow-down':'fa-long-arrow-up'">
            </span>
          </span>
        </div>
        <div class="oppia-learner-dashboard-main-content-container">
          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentIncompleteExplorations !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_INCOMPLETE_EXPLORATIONS"
                    translate-values="{numberNonexistent: <[numberNonexistentIncompleteExplorations]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="incompleteExplorationsList.length === 0">
              <div>
                <p ng-if="noExplorationActivity" translate="I18N_LEARNER_DASHBOARD_NO_ACTIVITY_IN_EXPLORATION"></p>
                <p ng-if="!noExplorationActivity" translate="I18N_LEARNER_DASHBOARD_EMPTY_INCOMPLETE_EXPLORATIONS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ng-repeat="tile in incompleteExplorationsList | orderBy:getValueOfExplorationSortKey:isCurrentExpSortDescending | limitTo:PAGE_SIZE:startIncompleteExpIndex track by tile.id"
                 style="display: inline-block; margin-left: 1px;"
                 ng-mouseenter="showRemoveIcon=true" ng-mouseleave="showRemoveIcon=false">
              <i class="remove-icon fa fa-times"
                 ng-show="showRemoveIcon"
                 aria-hidden="true"
                 ng-click="openRemoveActivityModal(activeSection, activeSubsection, tile)"
                 uib-tooltip="Remove"
                 tooltip-placement="top"></i>
              <exploration-summary-tile
                                      exploration-id="tile.id"
                                      exploration-title="tile.title"
                                      last-updated-msec="tile.last_updated_msec"
                                      objective="tile.objective"
                                      category="tile.category"
                                      ratings="tile.ratings"
                                      num-views="tile.num_views"
                                      thumbnail-icon-url="tile.thumbnail_icon_url"
                                      thumbnail-bg-color="tile.thumbnail_bg_color"
                                      class="protractor-test-exp-summary-tile">
              </exploration-summary-tile>
            </div>

            <div class="oppia-learner-dashboard-page-portfolio"
                 ng-if="incompleteExplorationsList.length > 8">
              <i class="material-icons md-18"
                 ng-click="goToPreviousPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)">&#xE5C4;</i>
              Showing <[startIncompleteExpIndex + 1]> - <[Math.min(startIncompleteExpIndex + PAGE_SIZE, incompleteExplorationsList.length)]> of <[incompleteExplorationsList.length]>
              <i class="material-icons md-18" ng-click="goToNextPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)">&#xE5C8;</i>
            </div>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentCompletedExplorations !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_COMPLETED_EXPLORATIONS"
                    translate-values="{numberNonexistent: <[numberNonexistentCompletedExplorations]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="completedExplorationsList.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_COMPLETED_EXPLORATIONS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ng-repeat="tile in completedExplorationsList | orderBy:getValueOfExplorationSortKey:isCurrentExpSortDescending track by tile.id"
                 style="display: inline-block; margin-left: 1px;">
              <exploration-summary-tile
                                      exploration-id="tile.id"
                                      exploration-title="tile.title"
                                      last-updated-msec="tile.last_updated_msec"
                                      objective="tile.objective"
                                      category="tile.category"
                                      ratings="tile.ratings"
                                      num-views="tile.num_views"
                                      thumbnail-icon-url="tile.thumbnail_icon_url"
                                      thumbnail-bg-color="tile.thumbnail_bg_color"
                                      class="protractor-test-exp-summary-tile">
              </exploration-summary-tile>
            </div>

            <div class="oppia-learner-dashboard-page-portfolio"
                 ng-if="completedExplorationsList.length > 8">
              <i class="material-icons md-18"
                 ng-click="goToPreviousPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)">&#xE5C4;</i>
              Showing <[startCompletedExpIndex + 1]> - <[Math.min(startCompletedExpIndex + PAGE_SIZE, completedExplorationsList.length)]> of <[completedExplorationsList.length]>
              <i class="material-icons md-18" ng-click="goToNextPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS)">&#xE5C8;</i>
            </div>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.EXPLORATIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="explorationPlaylist.length > 0">
              <span translate="I18N_LEARNER_DASHBOARD_REARRANGE_LEARNER_PLAYLIST_MESSAGE"></span>
            </span>
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentExplorationsFromPlaylist !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_EXPLORATIONS_FROM_PLAYLIST"
                    translate-values="{numberNonexistent: <[numberNonexistentExplorationsFromPlaylist]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="explorationPlaylist.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_EXPLORATION_PLAYLIST"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ui-sortable="explorationPlaylistSortableOptions" ng-model="explorationPlaylist">
              <div class="oppia-learner-playlist-tiles"
                   ng-repeat="tile in explorationPlaylist track by $index"
                   ng-mouseenter="showRemoveIcon=true" ng-mouseleave="showRemoveIcon=false"
                   style="height: 145px;">
                <i class="remove-icon fa fa-times"
                   ng-show="showRemoveIcon"
                   aria-hidden="true"
                   style="color: black;"
                   ng-click="openRemoveActivityModal(activeSection, activeSubsection, tile)"
                   uib-tooltip="Remove"
                   tooltip-placement="top"></i>
                <exploration-summary-tile style="height: 145px; display: block;"
                                          exploration-id="tile.id"
                                          exploration-title="tile.title"
                                          last-updated-msec="tile.last_updated_msec"
                                          objective="tile.objective"
                                          category="tile.category"
                                          ratings="tile.ratings"
                                          num-views="tile.num_views"
                                          thumbnail-icon-url="tile.thumbnail_icon_url"
                                          thumbnail-bg-color="tile.thumbnail_bg_color"
                                          class="protractor-test-exp-summary-tile"
                                          is-playlist-tile="true">
                </exploration-summary-tile>
              </div>
            </div>

          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentIncompleteCollections !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_INCOMPLETE_COLLECTIONS"
                    translate-values="{numberNonexistent: <[numberNonexistentIncompleteCollections]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="incompleteCollectionsList.length === 0">
              <div>
                <p ng-if="noCollectionActivity" translate="I18N_LEARNER_DASHBOARD_NO_ACTIVITY_IN_COLLECTION"></p>
                <p ng-if="!noCollectionActivity" translate="I18N_LEARNER_DASHBOARD_EMPTY_INCOMPLETE_COLLECTIONS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ng-repeat="tile in incompleteCollectionsList"
                 style="display: inline-block; margin-left: 1px;"
                 ng-mouseenter="showRemoveIcon=true" ng-mouseleave="showRemoveIcon=false">
              <i class="remove-icon fa fa-times"
                 ng-show="showRemoveIcon"
                 aria-hidden="true"
                 ng-click="openRemoveActivityModal(activeSection, activeSubsection, tile)"
                 uib-tooltip="Remove"
                 tooltip-placement="top"></i>
              <collection-summary-tile
                                       collection-id="tile.id"
                                       collection-title="tile.title"
                                       last-updated-msec="tile.last_updated_msec"
                                       objective="tile.objective"
                                       node-count="tile.node_count"
                                       category="tile.category"
                                       thumbnail-icon-url="tile.thumbnail_icon_url"
                                       thumbnail-bg-color="tile.thumbnail_bg_color">
              </collection-summary-tile>
            </div>

            <div class="oppia-learner-dashboard-page-portfolio"
                 ng-if="incompleteCollectionsList.length > 8">
              <i class="material-icons md-18"
                 ng-click="goToPreviousPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)">&#xE5C4;</i>
              Showing <[startIncompleteCollectionIndex + 1]> - <[Math.min(startIncompleteCollectionIndex + PAGE_SIZE, incompleteCollectionsList.length)]> of <[incompleteCollectionsList.length]>
              <i class="material-icons md-18" ng-click="goToNextPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.INCOMPLETE, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)">&#xE5C8;</i>
            </div>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.PLAYLIST && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="collectionPlaylist.length > 0">
              <span translate="I18N_LEARNER_DASHBOARD_REARRANGE_LEARNER_PLAYLIST_MESSAGE"></span>
            </span>
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentCollectionsFromPlaylist !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_COLLECTIONS_FROM_PLAYLIST"
                    translate-values="{numberNonexistent: <[numberNonexistentCollectionsFromPlaylist]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="collectionPlaylist.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_COLLECTION_PLAYLIST"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ui-sortable="collectionPlaylistSortableOptions" ng-model="collectionPlaylist">
              <div class="oppia-learner-playlist-tiles"
                   ng-repeat="tile in collectionPlaylist track by $index"
                   style="display: inline-block; margin-left: 1px; height: 145px;"
                   ng-mouseenter="showRemoveIcon=true" ng-mouseleave="showRemoveIcon=false">
                <i class="remove-icon fa fa-times"
                   ng-show="showRemoveIcon"
                   style="color: black;"
                   aria-hidden="true"
                   ng-click="openRemoveActivityModal(activeSection, activeSubsection, tile)"
                   uib-tooltip="Remove"
                   tooltip-placement="top"></i>
                <collection-summary-tile style="height: 145px; display: block;"
                                         collection-id="tile.id"
                                         collection-title="tile.title"
                                         last-updated-msec="tile.last_updated_msec"
                                         objective="tile.objective"
                                         node-count="tile.node_count"
                                         category="tile.category"
                                         thumbnail-icon-url="tile.thumbnail_icon_url"
                                         thumbnail-bg-color="tile.thumbnail_bg_color"
                                         is-playlist-tile="true">
                </collection-summary-tile>
              </div>
            </div>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED && activeSubsection === LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS">
            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="completedToIncompleteCollections.length !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_COMPLETED_TO_INCOMPLETE_COLLECTIONS"
                    translate-values="{numberMoved: completedToIncompleteCollections.length}">
              </span>
              <span>
                <ul>
                  <li ng-repeat="title in completedToIncompleteCollections"><[title]></li>
                </ul>
              </span>
            </span>

            <span style="display: block; padding: 5px 7.5px;"
                  ng-if="numberNonexistentCompletedCollections !== 0">
              <span translate="I18N_LEARNER_DASHBOARD_NONEXISTENT_COMPLETED_COLLECTIONS"
                    translate-values="{numberNonexistent: <[numberNonexistentCompletedCollections]>}"
                    translate-interpolation="messageformat"></span>
              &#9785
            </span>

            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="completedCollectionsList.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_COMPLETED_COLLECTIONS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <div ng-repeat="tile in completedCollectionsList"
                 style="display: inline-block; margin-left: 1px;">
              <collection-summary-tile
                                       collection-id="tile.id"
                                       collection-title="tile.title"
                                       last-updated-msec="tile.last_updated_msec"
                                       objective="tile.objective"
                                       node-count="tile.node_count"
                                       category="tile.category"
                                       thumbnail-icon-url="tile.thumbnail_icon_url"
                                       thumbnail-bg-color="tile.thumbnail_bg_color">
              </collection-summary-tile>
            </div>

            <div class="oppia-learner-dashboard-page-portfolio"
                 ng-if="completedCollectionsList.length > 8">
              <i class="material-icons md-18"
                 ng-click="goToPreviousPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETED, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)">&#xE5C4;</i>
              Showing <[startCompletedCollectionIndex + 1]> - <[Math.min(startCompletedCollectionIndex + PAGE_SIZE, completedCollectionsList.length)]> of <[completedCollectionsList.length]>
              <i class="material-icons md-18" ng-click="goToNextPage(LEARNER_DASHBOARD_SECTION_I18N_IDS.COMPLETE, LEARNER_DASHBOARD_SUBSECTION_I18N_IDS.COLLECTIONS)">&#xE5C8;</i>
            </div>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.SUBSCRIPTIONS" style="margin-top: 5px;">
            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="subscriptionsList.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_SUBSCRIPTIONS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <md-card class="oppia-subscription-card"
                     ng-repeat="subscription in subscriptionsList | orderBy:getValueOfSubscriptionSortKey:isCurrentSubscriptionSortDescending"
                     style="margin: 0 8px 0 4px; width: 197px;">
              <a class="oppia-subscription-profile-link" href="/profile/<[subscription.creator_username]>" target="_blank">
                <img ng-src="<[subscription.creator_picture_data_url]>" class="oppia-subscription-card-profile-picture img-circle">
                <span class="oppia-subscription-card-summary" style="color: black;">
                  <div style="margin-bottom: 5px; font-size: 17.5px;">
                    <strong class="protractor-test-subscription-name"
                            popover-append-to-body
                            popover-trigger="<[showUsernamePopover(subscription.creator_username)]>"
                            ng-attr-uib-popover="<[subscription.creator_username]>">
                      <[subscription.creator_username| truncate:10]>
                    </strong>
                  </div>
                  <div style="font-size: 14.5px;">
                    <span>Impact</span>
                    <span><[subscription.creator_impact || 0]></span>
                  </div>
                </span>
              </a>
            </md-card>
          </div>

          <div ng-if="activeSection === LEARNER_DASHBOARD_SECTION_I18N_IDS.FEEDBACK" class="oppia-learner-dashboard-feedback-section">
            <md-card layout="row"
                     class="oppia-learner-dashboard-no-activity-card"
                     ng-if="threadSummaries.length === 0">
              <div>
                <p translate="I18N_LEARNER_DASHBOARD_EMPTY_FEEDBACK_THREADS"></p>

                <a class="btn oppia-dashboard-intro-button oppia-transition-200"
                   translate="I18N_ACTION_BROWSE_LESSONS"
                   ng-href="/library"
                   style="width: 230px; margin-top: 13px;">
                </a>
              </div>
            </md-card>

            <table class="table" ng-if="!feedbackThreadActive">
              <tr ng-repeat="thread in threadSummaries | orderBy:sortFeedbackFunction:isCurrentFeedbackSortDescending"
                  ng-click="onClickThread(thread.status, thread.explorationId, thread.threadId, thread.explorationTitle)"
                  class="oppia-feedback-tab-row protractor-test-feedback-thread">
                <td class="col-lg-1 col-md-1 col-sm-1">
                  <span ng-class="getLabelClass(thread.status)"><[getHumanReadableStatus(thread.status)]></span>
                </td>
                <td class="col-lg-3 col-md-3 col-sm-3" style="width: 21%;">
                  <span ng-if="thread.totalMessageCount > 1">
                    <span ng-if="thread.authorSecondLastMessage">
                      <span ng-if="thread.secondLastMessageRead"><[thread.authorSecondLastMessage | truncate:7]>, </span>
                      <span ng-if="!thread.secondLastMessageRead">
                        <strong><[thread.authorSecondLastMessage | truncate:7]>, </strong>
                      </span>
                    </span>
                    <span ng-if="!thread.authorSecondLastMessage">
                      <span ng-if="thread.totalMessageCount > 1">
                        <span translate="I18N_FEEDBACK_MESSAGE_ANONYMOUS_AUTHOR"></span>,
                      </span>
                    </span>
                  </span>
                  <span ng-if="thread.authorLastMessage">
                    <span ng-if="thread.lastMessageRead"><[thread.authorLastMessage | truncate:7]></span>
                    <span ng-if="!thread.lastMessageRead">
                      <strong><[thread.authorLastMessage | truncate:7]></strong>
                    </span>
                  </span>
                  <span ng-if="!thread.authorLastMessage">
                    <span translate="I18N_FEEDBACK_MESSAGE_ANONYMOUS_AUTHOR"></span>
                  </span>
                  <span class="feedback-thread-message-count">(<[thread.totalMessageCount]>)</span>
                </td>
                <td class="col-lg-6 col-md-6 col-sm-6" style="width: 58%;">
                  <span ng-if="thread.totalMessageCount > 1 && thread.secondLastMessageRead && thread.lastMessageRead"><[thread.explorationTitle]> -</span>
                  <span class="protractor-test-feedback-exploration" ng-if="thread.totalMessageCount === 1 && thread.lastMessageRead"><[thread.explorationTitle]> -</span>
                  <span ng-if="thread.totalMessageCount === 1 && !thread.lastMessageRead">
                    <strong><[thread.explorationTitle]> -</strong>
                  </span>
                  <span ng-if="thread.totalMessageCount > 1 && (!thread.lastMessageRead || !thread.secondLastMessageRead)">
                    <strong><[thread.explorationTitle]> -</strong>
                  </span>
                  <span ng-if="thread.lastMessageText"><[thread.lastMessageText | truncate:50]></span>
                  <span ng-if="!thread.lastMessageText && thread.totalMessageCount !== 1">
                    <i translate="I18N_LEARNER_DASHBOARD_FEEDBACK_THREAD_STATUS_CHANGE_MESSAGE"
                       translate-values="{threadStatus: getHumanReadableStatus(thread.status)}"></i>
                  </span>
                  <span ng-if="!thread.lastMessageText && thread.totalMessageCount === 1"><i translate="I18N_LEARNER_DASHBOARD_SUGGESTION_TEXT"></i></span>
                <td class="col-lg-2 col-md-2 col-sm-2">
                  <span><[getLocaleAbbreviatedDatetimeString(thread.lastUpdated)]></span>
                </td>
              </tr>
            </table>

            <table class="table" ng-if="feedbackThreadActive">
              <tr>
                <td>
                  <button ng-click="showAllThreads()"
                          class="btn btn-default"
                          style="padding: 0 3px;">
                    <i class="material-icons oppia-vcenter" title="<['I18N_LEARNER_DASHBOARD_RETURN_TO_FEEDBACK_THREADS_MESSAGE' | translate]>">&#xE5CB;</i>
                  </button>
                  <span style="margin-left: 7px; font-size: 105%;"><[explorationTitle]></span>
                </td>
              </tr>

              <tr ng-repeat="message in messageSummaries" style="padding: 13px 8px 7px 8px;">
                <td>
                  <div class="row">
                    <div class="col-sm-9">
                      <span class="feedback-message-header">
                        <span ng-if="message.authorPictureDataUrl" style="display: inline-block;">
                          <img ng-src="<[message.authorPictureDataUrl]>"
                               class="oppia-navbar-profile-picture img-circle"
                               alt="User Avatar"
                               style="margin-top: 4px; min-width: 32px;">
                        </span>

                        <span ng-if="!message.authorPictureDataUrl" style="display: inline-block;">
                          <i class="material-icons md-40" style="margin-top: 4px; min-width: 32px;">&#xE853;</i>
                        </span>
                      </span>

                      <span ng-if="message.authorUsername" class="feedback-message-author-name"><strong><[message.authorUsername]></strong></span>
                      <span ng-if="!message.authorUsername" class="feedback-message-author-name"><strong translate="I18N_FEEDBACK_MESSAGE_ANONYMOUS_AUTHOR"></strong></span>
                      <span style="float: right; margin-right: 15px;"
                            ng-if="message.messageId !== 0 && message.updatedStatus">
                        <em translate="I18N_LEARNER_DASHBOARD_FEEDBACK_THREAD_STATUS_CHANGE_MESSAGE"
                            translate-values="{threadStatus: getHumanReadableStatus(message.updatedStatus)}"></em>
                      </span>
                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3">
                      <span><[getLocaleAbbreviatedDatetimeString(message.createdOn)]></span>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-sm-2 feedback-message-spacing" style="width: 8%;"></div>
                    <div class="col-sm-10 feedback-thread-message-body">
                      <div>
                        <span class="protractor-test-feedback-message" ng-if="message.text"><[message.text]></span>
                          <button style="margin-top: 5px;"
                                  ng-if="message.currentContentHtml"
                                  class="btn btn-primary"
                                  ng-click="showSuggestionModal(message.suggestionHtml, message.currentContentHtml, message.description)"
                                  translate="I18N_LEARNER_DASHBOARD_VIEW_SUGGESTION">
                          </button>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>

              <tr>
                <td>
                  <div class="row">
                    <div class="col-sm-1 feedback-message-author-picture" style="width: 8%; padding: 0;">
                      <span class="feedback-message-header">
                        <span style="display: inline-block;">
                          <img ng-src="<[profilePictureDataUrl]>"
                               class="oppia-navbar-profile-picture img-circle feedback-thread-learner-profile-pic"
                               alt="User Avatar">
                        </span>
                      </span>
                    </div>

                    <div class="col-sm-11">
                      <div class="feedback-thread-new-message">
                        <textarea class="form-control feedback-thread-reply-box"
                                  placeholder="<['I18N_LEARNER_DASHBOARD_FEEDBACK_THREAD_DEFAULT_MESSAGE' | translate]>" ng-model="newMessage.text"
                                  style=""></textarea>
                      </div>
                      <div>
                        <button class="btn btn-success feedback-thread-new-message-send"
                                ng-click="addNewMessage(explorationId, threadId, newMessage.text)"
                                ng-disabled="messageSendingInProgress || !newMessage.text">
                          <span ng-if="messageSendingInProgress" translate="I18N_LEARNER_DASHBOARD_SEND_FEEDBACK_THREAD_MESSAGE_IN_PROGRESS"></span>
                          <span class="protractor-test-feedback-send-message"
                                ng-if="!messageSendingInProgress"
                                translate="I18N_LEARNER_DASHBOARD_SEND_FEEDBACK_THREAD_MESSAGE"></span>
                        </button>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
            <div class="feedback-thread-warning" ng-if="feedbackThreadActive">
              <i class="material-icons">&#xE88F;</i>
              <span translate="I18N_LEARNER_DASHBOARD_FEEDBACK_THREAD_WARNING"></span>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-2 oppia-learner-dashboard-side-content"
           ng-class="{'oppia-learner-dashboard-mobile-mode': checkMobileView()}">

      </div>
    </div>
  </div>

{% endblock %}

{% block footer_js %}
  {{ super() }}
  <script src="{{TEMPLATE_DIR_PREFIX}}/components/background/BackgroundBannerDirective.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/components/summary_tile/CollectionSummaryTileDirective.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/components/summary_tile/ExplorationSummaryTileDirective.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/components/RatingComputationService.js"></script>

  <script src="{{TEMPLATE_DIR_PREFIX}}/domain/feedback_thread/FeedbackThreadSummaryObjectFactory.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/domain/feedback_message/FeedbackMessageSummaryObjectFactory.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/pages/exploration_editor/feedback_tab/ThreadStatusDisplayService.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/domain/learner_dashboard/LearnerDashboardBackendApiService.js"></script>
  <script src="{{TEMPLATE_DIR_PREFIX}}/pages/learner_dashboard/LearnerDashboard.js"></script>
{% endblock footer_js %}
