<script type="text/ng-template" id="skins/TutorCard">

  <div class="conversation-skin-main-tutor-card"
       ng-class="{'animate-card-width': startCardChangeAnimation,
                  'has-shadow': isViewportNarrow() && !isInteractionInline,
                  'conversation-skin-animate-tutor-card-on-narrow': isViewportNarrow() && isInteractionInline}">
    <div class="conversation-skin-tutor-card-content conversation-skin-animate-card-contents"
         ng-class="{'animate-card-change': startCardChangeAnimation}">
      <div class="conversation-skin-tutor-card-top-section">
        <img class="conversation-skin-oppia-avatar"
             ng-src="<[OPPIA_AVATAR_IMAGE_URL]>" alt="">
        <div class="conversation-skin-tutor-card-top-content protractor-test-conversation-content"
             angular-html-bind="activeCard.contentHtml"
             focus-on="<[getContentFocusLabel($index)]>">
        </div>
      </div>

      <div ng-if="(activeCard.answerFeedbackPairs.length > 1 && isInteractionInline) || (activeCard.answerFeedbackPairs.length > 0 && !isInteractionInline)">
        <h4 class="conversation-skin-responses-dropdown-container"
            ng-click="toggleShowPreviousResponses()">
          <span class="conversation-skin-responses-dropdown-text">
            <span translate="I18N_PLAYER_PREVIOUS_RESPONSES"
                  translate-values="{previousResponses: <[activeCard.answerFeedbackPairs.length - (isInteractionInline ? 1 : 0)]>}">
            </span>
            <span class="conversation-skin-responses-dropdown-icon"
                  ng-class="{'conversation-skin-responses-dropdown-icon-rotated': arePreviousResponsesShown}">
              <i class="material-icons">&#xE037;</i>
            </span>
          </span>
        </h4>
      </div>

      <div ng-show="arePreviousResponsesShown"
           class="conversation-skin-tutor-card-middle-section conversation-skin-responses-animate-slide">
        <div ng-repeat="responsePair in activeCard.answerFeedbackPairs track by $index">
          <div ng-if="!$last || !isInteractionInline">
            <answer-feedback-pair data="responsePair"
                                  profile-picture="profilePicture"
                                  oppia-avatar-image-url="OPPIA_AVATAR_IMAGE_URL">
            </answer-feedback-pair>
          </div>
        </div>
      </div>

      <!-- If the interaction is inline, always show the most recent response pair, if there is one. -->
      <div class="conversation-skin-tutor-card-bottom-section" ng-if="isInteractionInline && activeCard.answerFeedbackPairs.length > 0">
        <answer-feedback-pair data="activeCard.answerFeedbackPairs[activeCard.answerFeedbackPairs.length - 1]"
                              profile-picture="profilePicture"
                              oppia-avatar-image-url="OPPIA_AVATAR_IMAGE_URL">
        </answer-feedback-pair>
      </div>

      <!--
        Show the interaction (if it is inline), the interaction instructions
        (if the interaction is supplemental), or a continuation button (if
        Oppia has given feedback and the learner is being asked to move on
        to the next card).

        In addition, if the exploration is iframed, the terminal card will
        have no learner input section, so we do not show it.
      -->
    <!--  <div ng-if="isInteractionInline && !waitingForOppiaFeedback &&
      ((activeCard.interactionHtml && !activeCard.destStateName) || activeCard.destStateName) &&
      (!isOnTerminalCard() || !isIframed || activeCard.destStateName) && isCurrentCardAtEndOfTranscript()"> -->
      // TODO: This is fake
      <div ng-if="isInteractionInline">
        <div class="conversation-skin-inline-interaction">
          <div ng-if="activeCard.destStateName && activeCard.answerFeedbackPairs[activeCard.answerFeedbackPairs.length - 1].oppiaFeedbackHtml">
            <md-button class="oppia-learner-continue-button protractor-test-continue-to-next-card-button"
                       focus-on="<[CONTINUE_BUTTON_FOCUS_LABEL]>"
                       ng-click="showNextCard()"
                       translate="I18N_PLAYER_CONTINUE_BUTTON"
                       aria-label="Continue">
            </md-button>
          </div>
          <div ng-if="activeCard.interactionHtml && !activeCard.destStateName">
            <div class="protractor-test-conversation-input"
                 angular-html-bind="activeCard.interactionHtml">
            </div>
          </div>
        </div>
      </div>

      <div ng-if="!isInteractionInline"
          class="conversation-skin-inline-interaction" style="opacity: 0.8;">
        <div ng-if="!isViewportNarrow()" style="padding: 6px 12px;">
          <[interactionInstructions]>
          <i class="material-icons md-18" style="position: relative; top: 3px;">&#xE5C8;</i>
        </div>
        <div ng-if="isViewportNarrow()">
          <md-button class="instructions-button" ng-click="showSupplementalCard()">
            <[interactionInstructions]>
          </md-button>
        </div>
      </div>

      <div ng-if="!activeCard.interactionHtml && !isOnTerminalCard()">
        <div class="conversation-skin-inline-interaction">
          <span style="color: red;">
            <strong>Error</strong>: No interaction specified for '<[activeCard.stateName]>'.
          </span>
        </div>
      </div>
    </div>
  </div>
</script>