
  <!DOCTYPE html>
  <html>
    <head>
      <title>topic-update.service.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">core/templates/domain/topic/topic-update.service.ts</td><td class="">88.87%</td><td class="">100%</td><td class="">1141</td><td class="">1014</td><td class="">127</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">// Copyright 2020 The Oppia Authors. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS-IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Service to build changes to a topic. These changes may
 * then be used by other services, such as a backend API service to update the
 * topic in the backend. This service also registers all changes with the
 * undo/redo service.
 * The addCanonicalStory and addAdditionalStory functions are not present here
 * as this process is carried out in the backend when a story is created, as a
 * story would always be linked to a topic.
 */

import { Injectable } from &#x27;@angular/core&#x27;;
import { downgradeInjectable } from &#x27;@angular/upgrade/static&#x27;;

import cloneDeep from &#x27;lodash/cloneDeep&#x27;;

import { Change, TopicChange } from &#x27;domain/editor/undo_redo/change.model&#x27;;
import { UndoRedoService } from &#x27;domain/editor/undo_redo/undo-redo.service&#x27;;
import { TopicDomainConstants } from &#x27;domain/topic/topic-domain.constants&#x27;;
import { Topic } from &#x27;core/templates/domain/topic/TopicObjectFactory&#x27;;
import { ShortSkillSummary } from &#x27;core/templates/domain/skill/short-skill-summary.model&#x27;;
import { SubtitledHtml } from &#x27;core/templates/domain/exploration/subtitled-html.model&#x27;;
import { SubtopicPage } from &#x27;core/templates/domain/topic/subtopic-page.model&#x27;;
import { RecordedVoiceovers } from &#x27;core/templates/domain/exploration/recorded-voiceovers.model&#x27;;
import { Subtopic } from &#x27;domain/topic/subtopic.model&#x27;;

type TopicUpdateApply = (topicChange: TopicChange, topic: Topic) =&gt; void;
type TopicUpdateReverse = (topicChange: TopicChange, topic: Topic) =&gt; void;
type SubtopicUpdateApply = (
  topicChange: TopicChange, subtopicPage: SubtopicPage) =&gt; void;
type SubtopicUpdateReverse = (
  topicChange: TopicChange, subtopicPage: SubtopicPage) =&gt; void;

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class TopicUpdateService {
  constructor(private undoRedoService: UndoRedoService) {}
  // Creates a change using an apply function, reverse function, a change
  // command and related parameters. The change is applied to a given
  // topic.
  // entity can be a topic object or a subtopic page object.
  private _applyChange(
      entity,
      command: string, params,
      apply: TopicUpdateApply | SubtopicUpdateApply,
      reverse: TopicUpdateReverse | SubtopicUpdateReverse) {
    let changeDict = cloneDeep(params);
    changeDict.cmd = command;
    let changeObj = new Change(changeDict, apply, reverse);
    this.undoRedoService.applyChange(changeObj, entity);
  }

  private _getParameterFromChangeDict(changeDict, paramName: string) {
    return changeDict[paramName];
  }

  // Applies a topic property change, specifically. See _applyChange()
  // for details on the other behavior of this function.
  private _applyTopicPropertyChange(
      topic: Topic, propertyName: string, newValue: string|boolean,
      oldValue: string|boolean,
      apply: TopicUpdateApply, reverse: TopicUpdateReverse) {
    this._applyChange(topic, TopicDomainConstants.CMD_UPDATE_TOPIC_PROPERTY, {
      property_name: propertyName,
      new_value: cloneDeep(newValue),
      old_value: cloneDeep(oldValue) || null
    }, apply, reverse);
  }

  private _applySubtopicPropertyChange(
      topic: Topic, propertyName: string, subtopicId: number, newValue: string,
      oldValue: string,
      apply: SubtopicUpdateApply, reverse: SubtopicUpdateReverse) {
    this._applyChange(
      topic, TopicDomainConstants.CMD_UPDATE_SUBTOPIC_PROPERTY, {
        subtopic_id: subtopicId,
        property_name: propertyName,
        new_value: cloneDeep(newValue),
        old_value: cloneDeep(oldValue)
      }, apply, reverse);
  }

  private _applySubtopicPagePropertyChange(
      subtopicPage: SubtopicPage, propertyName: string,
      subtopicId: number, newValue, oldValue,
      apply: SubtopicUpdateApply, reverse: SubtopicUpdateReverse): void {
    this._applyChange(
      subtopicPage, TopicDomainConstants.CMD_UPDATE_SUBTOPIC_PAGE_PROPERTY, {
        subtopic_id: subtopicId,
        property_name: propertyName,
        new_value: cloneDeep(newValue),
        old_value: cloneDeep(oldValue)
      }, apply, reverse);
  }

  private _getNewPropertyValueFromChangeDict(changeDict) {
    return this._getParameterFromChangeDict(changeDict, &#x27;new_value&#x27;);
  }

  private _getSubtopicIdFromChangeDict(changeDict) {
    return this._getParameterFromChangeDict(changeDict, &#x27;subtopic_id&#x27;);
  }

  // These functions are associated with updates available in
  // core.domain.topic_services.apply_change_list.

  /**
   * Changes the name of a topic and records the change in the
   * undo/redo service.
   */
  setTopicName(
      topic: Topic, name: string): void {
    let oldName = cloneDeep(topic.getName());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_NAME, name, oldName,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let name = this._getNewPropertyValueFromChangeDict(changeDict);
        topic.setName(name);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setName(oldName);
      });
  }

  /**
   * Changes the abbreviated name of a topic and records the change in the
   * undo/redo service.
   */
  setAbbreviatedTopicName(
      topic: Topic, abbreviatedName: string): void {
    let oldAbbreviatedName = cloneDeep(topic.getAbbreviatedName());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_ABBREVIATED_NAME,
      abbreviatedName, oldAbbreviatedName,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let name = this._getNewPropertyValueFromChangeDict(changeDict);
        topic.setAbbreviatedName(name);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setAbbreviatedName(oldAbbreviatedName);
      });
  }

  /**
   * Changes the meta tag content of a topic and records the change in the
   * undo/redo service.
   */
  setMetaTagContent(
      topic: Topic, metaTagContent: string): void {
    let oldMetaTagContent = cloneDeep(topic.getMetaTagContent());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_META_TAG_CONTENT,
      metaTagContent, oldMetaTagContent,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let metaTagContent = this._getNewPropertyValueFromChangeDict(
          changeDict);
        topic.setMetaTagContent(metaTagContent);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setMetaTagContent(oldMetaTagContent);
      });
  }

  /**
   * Changes the &#x27;practice tab is displayed&#x27; property of a topic and
   * records the change in the undo/redo service.
   */
  setPracticeTabIsDisplayed(
      topic: Topic, practiceTabIsDisplayed: boolean): void {
    let oldPracticeTabIsDisplayed = cloneDeep(
      topic.getPracticeTabIsDisplayed());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_PRACTICE_TAB_IS_DISPLAYED,
      practiceTabIsDisplayed, oldPracticeTabIsDisplayed,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let practiceTabIsDisplayed = this._getNewPropertyValueFromChangeDict(
          changeDict);
        topic.setPracticeTabIsDisplayed(practiceTabIsDisplayed);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setPracticeTabIsDisplayed(oldPracticeTabIsDisplayed);
      });
  }

  /**
   * Changes the page title fragment of a topic and records the change in the
   * undo/redo service.
   */
  setPageTitleFragmentForWeb(
      topic: Topic, pageTitleFragmentForWeb: string): void {
    let oldPageTitleFragmentForWeb = cloneDeep(
      topic.getPageTitleFragmentForWeb());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_PAGE_TITLE_FRAGMENT_FOR_WEB,
      pageTitleFragmentForWeb, oldPageTitleFragmentForWeb,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        var pageTitleFragmentForWeb = this._getNewPropertyValueFromChangeDict(
          changeDict);
        topic.setPageTitleFragmentForWeb(pageTitleFragmentForWeb);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setPageTitleFragmentForWeb(oldPageTitleFragmentForWeb);
      });
  }

  /**
   * Changes the url fragment of a topic and records the change in the
   * undo/redo service.
   */
  setTopicUrlFragment(
      topic: Topic, urlFragment: string): void {
    let oldUrlFragment = cloneDeep(topic.getUrlFragment());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_URL_FRAGMENT,
      urlFragment, oldUrlFragment,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let newUrlFragment = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        topic.setUrlFragment(newUrlFragment);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setUrlFragment(oldUrlFragment);
      });
  }
  /**
   * Changes the thumbnail filename of a topic and records the change in the
   * undo/redo service.
   */
  setTopicThumbnailFilename(
      topic: Topic, thumbnailFilename: string): void {
    let oldThumbnailFilename = cloneDeep(topic.getThumbnailFilename());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_THUMBNAIL_FILENAME,
      thumbnailFilename, oldThumbnailFilename,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let thumbnailFilename = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        topic.setThumbnailFilename(thumbnailFilename);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setThumbnailFilename(oldThumbnailFilename);
      });
  }

  /**
   * Changes the thumbnail background color of a topic and records the
   * change in the undo/redo service.
   */
  setTopicThumbnailBgColor(
      topic: Topic, thumbnailBgColor: string): void {
    let oldThumbnailBgColor = cloneDeep(topic.getThumbnailBgColor());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_THUMBNAIL_BG_COLOR,
      thumbnailBgColor, oldThumbnailBgColor,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let thumbnailBgColor = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        topic.setThumbnailBgColor(thumbnailBgColor);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setThumbnailBgColor(oldThumbnailBgColor);
      });
  }

  /**
   * Changes the description of a topic and records the change in the
   * undo/redo service.
   */
  setTopicDescription(
      topic: Topic, description: string): void {
    let oldDescription = cloneDeep(topic.getDescription());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_DESCRIPTION,
      description, oldDescription,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        var description = this._getNewPropertyValueFromChangeDict(changeDict);
        topic.setDescription(description);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setDescription(oldDescription);
      });
  }

  /**
   * Changes the language code of a topic and records the change in
   * the undo/redo service.
   */
  setTopicLanguageCode(
      topic: Topic, languageCode: string): void {
    let oldLanguageCode = cloneDeep(topic.getLanguageCode());
    this._applyTopicPropertyChange(
      topic, TopicDomainConstants.TOPIC_PROPERTY_LANGUAGE_CODE, languageCode,
      oldLanguageCode,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let languageCode = this._getNewPropertyValueFromChangeDict(changeDict);
        topic.setLanguageCode(languageCode);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.setLanguageCode(oldLanguageCode);
      });
  }

  /**
   * Creates a subtopic and adds it to the topic and records the change in
   * the undo/redo service.
   */
  addSubtopic(
      topic: Topic, title: string): void {
    let nextSubtopicId = topic.getNextSubtopicId();
    this._applyChange(topic, TopicDomainConstants.CMD_ADD_SUBTOPIC, {
      subtopic_id: nextSubtopicId,
      title: title
    }, (changeDict, topic) =&gt; {
      // ---- Apply ----
      topic.addSubtopic(title);
    }, (changeDict, topic) =&gt; {
      // ---- Undo ----
      let subtopicId = this._getSubtopicIdFromChangeDict(changeDict);
      topic.deleteSubtopic(subtopicId);
    });
  }

  /**
   * @param {Topic} topic - The topic object to be edited.
   * @param {number} subtopicId - The id of the subtopic to delete.
   */
  deleteSubtopic(
      topic: Topic, subtopicId: number): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    if (!subtopic) {
      throw new Error(`Subtopic with id ${subtopicId} doesn\&#x27;t exist`);
    }
    let newlyCreated = false;
    let changeList =
    this.undoRedoService.getCommittableChangeList();
    for (let i = 0; i &lt; changeList.length; i++) {
      let _changeList = changeList[i] as TopicChange;
      if (_changeList.cmd === &#x27;add_subtopic&#x27; &amp;&amp;
          _changeList.subtopic_id === subtopicId) {
        newlyCreated = true;
      }
    }
    if (newlyCreated) {
      // Get the current change list.
      let currentChangeList: Change[] = this.undoRedoService.getChangeList();
      let indicesToDelete = [];
      // Loop over the current changelist and handle all the cases where
      // a skill moved into the subtopic or moved out of it.
      for (var i = 0; i &lt; currentChangeList.length; i++) {
        let changeDict =
          currentChangeList[i].getBackendChangeObject();
        if (changeDict.cmd ===
          TopicDomainConstants.CMD_MOVE_SKILL_ID_TO_SUBTOPIC) {
          // If a skill was moved into the subtopic, then that change is
          // modified to have the skill move into the uncategorized section
          // since after this delete, it would be as if this subtopic never
          // existed.
          if (changeDict.new_subtopic_id === subtopicId) {
            // If the origin of the move operation was the uncategorized
            // section itself, delete that change, since no change is to be
            // done following the previous comment.
            if (changeDict.old_subtopic_id === null) {
              indicesToDelete.push(i);
            } else {
              // Change the move operation to the deleted subtopic to a
              // remove operation, to move that skill into the uncategorized
              // section from its origin.
              let _changeDict: TopicChange = {
                cmd: TopicDomainConstants.CMD_REMOVE_SKILL_ID_FROM_SUBTOPIC,
                subtopic_id: changeDict.old_subtopic_id,
                skill_id: changeDict.skill_id
              };
              changeDict = _changeDict;
            }
          } else if (changeDict.old_subtopic_id === subtopicId) {
            // Any operation where a skill was moved out of this subtopic
            // would now be equivalent to a move out from the uncategorized
            // section, as a newly created subtopic wouldn&#x27;t have any skills
            // of its own initially, and any skills moved into it have been
            // shifted to the uncategorized section.
            changeDict.old_subtopic_id = null;
          }
        } else if (changeDict.cmd ===
          TopicDomainConstants.CMD_REMOVE_SKILL_ID_FROM_SUBTOPIC) {
          // If a skill was removed from this subtopic, then that change
          // should be deleted, since all skills moved into the subtopic
          // have already been moved into the uncategorized section.
          if (changeDict.subtopic_id === subtopicId) {
            indicesToDelete.push(i);
          }
        }
        currentChangeList[i].setBackendChangeObject(changeDict);
      }
      for (let i = 0; i &lt; currentChangeList.length; i++) {
        let backendChangeDict =
          currentChangeList[i].getBackendChangeObject();
        // Check presence of member equivalent of hasOwnProperty
        // https://www.typescriptlang.org/docs/handbook/advanced-types.html
        if (&#x27;subtopic_id&#x27; in backendChangeDict) {
          if (backendChangeDict.subtopic_id === subtopicId) {
            // The indices in the change list corresponding to changes to
            // the currently deleted and newly created subtopic are to be
            // removed from the list.
            indicesToDelete.push(i);
            continue;
          }
          // When a newly created subtopic is deleted, the subtopics created
          // after it would have their id reduced by 1.
          if (backendChangeDict.subtopic_id &gt; subtopicId) {
            backendChangeDict.subtopic_id--;
          }
        }
        if (&#x27;old_subtopic_id&#x27; in backendChangeDict) {
          if (backendChangeDict.old_subtopic_id &gt; subtopicId) {
            backendChangeDict.old_subtopic_id--;
          }
        }
        if (&#x27;new_subtopic_id&#x27; in backendChangeDict) {
          if (backendChangeDict.new_subtopic_id &gt; subtopicId) {
            backendChangeDict.new_subtopic_id--;
          }
        }
        // Apply the above id reduction changes to the backend change.
        currentChangeList[i].setBackendChangeObject(backendChangeDict);
      }
      // The new change list is found by deleting the above found elements.
      let newChangeList = currentChangeList.filter((change) =&gt; {
        let changeObjectIndex = currentChangeList.indexOf(change);
        // Return all elements that were not deleted.
        return (indicesToDelete.indexOf(changeObjectIndex) === -1);
      });
      // The new changelist is set.
      this.undoRedoService.setChangeList(newChangeList);
      topic.deleteSubtopic(subtopicId, newlyCreated);
      return;
    }
    this._applyChange(topic, TopicDomainConstants.CMD_DELETE_SUBTOPIC, {
      subtopic_id: subtopicId
    }, (changeDict, topic) =&gt; {
      // ---- Apply ----
      topic.deleteSubtopic(subtopicId, newlyCreated);
    }, (changeDict, topic) =&gt; {
      // ---- Undo ----
      throw new Error(&#x27;A deleted subtopic cannot be restored&#x27;);
    });
  }

  /**
   * Moves a skill to a subtopic from either another subtopic or
   * uncategorized skills and records the change in the undo/redo service.
   */
  moveSkillToSubtopic(
      topic: Topic, oldSubtopicId: number,
      newSubtopicId: number, skillSummary: ShortSkillSummary): void {
    if (!newSubtopicId) {
      throw new Error(&#x27;New subtopic cannot be null&#x27;);
    }
    let oldSubtopic: Subtopic | null;
    if (oldSubtopicId) {
      oldSubtopic = topic.getSubtopicById(oldSubtopicId);
    }
    let newSubtopic = topic.getSubtopicById(newSubtopicId);
    this._applyChange(
      topic,
      TopicDomainConstants.CMD_MOVE_SKILL_ID_TO_SUBTOPIC, {
        old_subtopic_id: oldSubtopicId,
        new_subtopic_id: newSubtopicId, skill_id: skillSummary.getId(),
      }, (changeDict, topic) =&gt; {
        // ---- Apply ----
        if (!oldSubtopicId) {
          topic.removeUncategorizedSkill(skillSummary.getId());
        } else {
          oldSubtopic.removeSkill(skillSummary.getId());
        }
        newSubtopic.addSkill(
          skillSummary.getId(), skillSummary.getDescription());
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        newSubtopic.removeSkill(skillSummary.getId());
        if (oldSubtopicId === null) {
          topic.addUncategorizedSkill(
            skillSummary.getId(), skillSummary.getDescription());
        } else {
          oldSubtopic.addSkill(
            skillSummary.getId(), skillSummary.getDescription());
        }
      });
  }

  /**
   * Moves a skill from a subtopic to uncategorized skills
   * and records the change in the undo/redo service.
   */
  removeSkillFromSubtopic(
      topic: Topic, subtopicId: number,
      skillSummary: ShortSkillSummary): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    this._applyChange(
      topic, TopicDomainConstants.CMD_REMOVE_SKILL_ID_FROM_SUBTOPIC, {
        subtopic_id: subtopicId, skill_id: skillSummary.getId()
      }, (changeDict, topic) =&gt; {
        // ---- Apply ----
        subtopic.removeSkill(skillSummary.getId());
        if (!topic.hasUncategorizedSkill(skillSummary.getId())) {
          topic.addUncategorizedSkill(
            skillSummary.getId(), skillSummary.getDescription());
        }
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        subtopic.addSkill(
          skillSummary.getId(), skillSummary.getDescription());
        topic.removeUncategorizedSkill(skillSummary.getId());
      });
  }

  /**
   * Changes the thumbnail filename of a subtopic and records the change in
   * the undo/redo service.
   */
  setSubtopicThumbnailFilename(
      topic: Topic, subtopicId: number, thumbnailFilename: string): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    if (!subtopic) {
      throw new Error(`Subtopic with id ${subtopicId} doesn\&#x27;t exist`);
    }
    let oldThumbnailFilename = cloneDeep(
      subtopic.getThumbnailFilename());
    this._applySubtopicPropertyChange(
      topic, TopicDomainConstants.SUBTOPIC_PROPERTY_THUMBNAIL_FILENAME,
      subtopicId, thumbnailFilename, oldThumbnailFilename,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let thumbnailFilename = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        subtopic.setThumbnailFilename(thumbnailFilename);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        subtopic.setThumbnailFilename(oldThumbnailFilename);
      });
  }

  /**
   * Changes the url fragment of a subtopic and records the change in
   * the undo/redo service.
   */
  setSubtopicUrlFragment(
      topic: Topic, subtopicId: number, urlFragment: string): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    if (!subtopic) {
      throw new Error(`Subtopic with id ${subtopicId} doesn\&#x27;t exist`);
    }
    let oldUrlFragment = cloneDeep(subtopic.getUrlFragment());
    this._applySubtopicPropertyChange(
      topic, TopicDomainConstants.SUBTOPIC_PROPERTY_URL_FRAGMENT, subtopicId,
      urlFragment, oldUrlFragment,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let newUrlFragment = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        subtopic.setUrlFragment(newUrlFragment);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        subtopic.setUrlFragment(oldUrlFragment);
      });
  }

  /**
   * Changes the thumbnail background color of a subtopic and records
   * the change in the undo/redo service.
   */
  setSubtopicThumbnailBgColor(
      topic: Topic, subtopicId: number, thumbnailBgColor: string): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    if (!subtopic) {
      throw new Error(`Subtopic with id ${subtopicId} doesn\&#x27;t exist`);
    }
    let oldThumbnailBgColor = cloneDeep(
      subtopic.getThumbnailBgColor());
    this._applySubtopicPropertyChange(
      topic, TopicDomainConstants.SUBTOPIC_PROPERTY_THUMBNAIL_BG_COLOR,
      subtopicId, thumbnailBgColor, oldThumbnailBgColor,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let thumbnailBgColor = (
          this._getNewPropertyValueFromChangeDict(changeDict));
        subtopic.setThumbnailBgColor(thumbnailBgColor);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        subtopic.setThumbnailBgColor(oldThumbnailBgColor);
      });
  }

  /**
   * Changes the title of a subtopic and records the change in
   * the undo/redo service.
   */
  setSubtopicTitle(
      topic: Topic, subtopicId: number, title: string): void {
    let subtopic = topic.getSubtopicById(subtopicId);
    if (!subtopic) {
      throw new Error(`Subtopic with id ${subtopicId} doesn\&#x27;t exist`);
    }
    let oldTitle = cloneDeep(subtopic.getTitle());
    this._applySubtopicPropertyChange(
      topic, TopicDomainConstants.SUBTOPIC_PROPERTY_TITLE,
      subtopicId, title, oldTitle,
      (changeDict, topic) =&gt; {
        // ---- Apply ----
        let title = this._getNewPropertyValueFromChangeDict(changeDict);
        subtopic.setTitle(title);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        subtopic.setTitle(oldTitle);
      });
  }

  setSubtopicPageContentsHtml(
      subtopicPage: SubtopicPage, subtopicId: number,
      newSubtitledHtml: SubtitledHtml): void {
    let oldSubtitledHtml = cloneDeep(
      subtopicPage.getPageContents().getSubtitledHtml());
    this._applySubtopicPagePropertyChange(
      subtopicPage,
      TopicDomainConstants.SUBTOPIC_PAGE_PROPERTY_PAGE_CONTENTS_HTML,
      subtopicId, newSubtitledHtml.toBackendDict(),
      oldSubtitledHtml.toBackendDict(),
      (changeDict, subtopicPage) =&gt; {
        // ---- Apply ----
        subtopicPage.getPageContents().setSubtitledHtml(newSubtitledHtml);
      }, (changeDict, subtopicPage) =&gt; {
        // ---- Undo ----
        subtopicPage.getPageContents().setSubtitledHtml(oldSubtitledHtml);
      });
  }

  setSubtopicPageContentsAudio(
      subtopicPage: SubtopicPage, subtopicId: number,
      newRecordedVoiceovers: RecordedVoiceovers): void {
    let oldRecordedVoiceovers = cloneDeep(
      subtopicPage.getPageContents().getRecordedVoiceovers());
    this._applySubtopicPagePropertyChange(
      subtopicPage,
      TopicDomainConstants.SUBTOPIC_PAGE_PROPERTY_PAGE_CONTENTS_AUDIO,
      subtopicId, newRecordedVoiceovers.toBackendDict(),
      oldRecordedVoiceovers.toBackendDict(),
      (changeDict, subtopicPage) =&gt; {
        // ---- Apply ----
        subtopicPage.getPageContents().setRecordedVoiceovers(
          newRecordedVoiceovers);
      }, (changeDict, subtopicPage) =&gt; {
        // ---- Undo ----
        subtopicPage.getPageContents().setRecordedVoiceovers(
          oldRecordedVoiceovers);
      });
  }

  /**
   * Removes an additional story id from a topic and records the change
   * in the undo/redo service.
   */
  removeAdditionalStory(
      topic: Topic, storyId: string): void {
    this._applyChange(
      topic, TopicDomainConstants.CMD_DELETE_ADDITIONAL_STORY, {
        story_id: storyId
      }, (changeDict, topic) =&gt; {
        // ---- Apply ----
        topic.removeAdditionalStory(storyId);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.addAdditionalStory(storyId);
      });
  }

  /**
   * Removes an canonical story id from a topic and records the change
   * in the undo/redo service.
   */
  removeCanonicalStory(
      topic: Topic, storyId: string): void {
    this._applyChange(topic, TopicDomainConstants.CMD_DELETE_CANONICAL_STORY, {
      story_id: storyId
    }, (changeDict, topic) =&gt;{
      // ---- Apply ----
      topic.removeCanonicalStory(storyId);
    }, (changeDict, topic) =&gt; {
      // ---- Undo ----
      topic.addCanonicalStory(storyId);
    });
  }

  /**
   * Rearranges or moves a canonical story to another position and
   * records the change in undo/redo service.
   */
  rearrangeCanonicalStory(
      topic: Topic, fromIndex: number, toIndex: number): void {
    this._applyChange(
      topic, TopicDomainConstants.CMD_REARRANGE_CANONICAL_STORY, {
        from_index: fromIndex,
        to_index: toIndex
      }, (changeDict, topic) =&gt; {
      // ---- Apply ----
        topic.rearrangeCanonicalStory(fromIndex, toIndex);
      }, (changeDict, topic) =&gt; {
      // ---- Undo ----
        topic.rearrangeCanonicalStory(toIndex, fromIndex);
      });
  }

  /**
   * Rearranges or moves a skill in a subtopic to another position and
   * records the change in undo/redo service.
   */
  rearrangeSkillInSubtopic(
      topic: Topic, subtopicId: number,
      fromIndex: number, toIndex: number): void {
    this._applyChange(
      topic, TopicDomainConstants.CMD_REARRANGE_SKILL_IN_SUBTOPIC, {
        subtopic_id: subtopicId,
        from_index: fromIndex,
        to_index: toIndex
      }, (changeDict, topic) =&gt; {
        // ---- Apply ----
        topic.rearrangeSkillInSubtopic(subtopicId, fromIndex, toIndex);
      }, (changeDict, topic) =&gt; {
        // ---- Undo ----
        topic.rearrangeSkillInSubtopic(subtopicId, toIndex, fromIndex);
      });
  }

  /**
   * Rearranges a subtopic to another position and records the change in
   * undo/redo service.
   */
  rearrangeSubtopic(
      topic: Topic, fromIndex: number, toIndex: number): void {
    this._applyChange(topic, TopicDomainConstants.CMD_REARRANGE_SUBTOPIC, {
      from_index: fromIndex,
      to_index: toIndex
    }, (changeDict, topic) =&gt; {
      // ---- Apply ----
      topic.rearrangeSubtopic(fromIndex, toIndex);
    }, (changeDict, topic) =&gt; {
      // ---- Undo ----
      topic.rearrangeSubtopic(toIndex, fromIndex);
    });
  }

  /**
   * Removes an uncategorized skill from a topic and records the change
   * in the undo/redo service.
   */
  removeUncategorizedSkill(
      topic: Topic, skillSummary: ShortSkillSummary): void {
    this._applyChange(
      topic, TopicDomainConstants.CMD_REMOVE_UNCATEGORIZED_SKILL_ID, {
        uncategorized_skill_id: skillSummary.getId()
      }, (changeDict, topic) =&gt; {
        // ---- Apply ----
        let newSkillId = this._getParameterFromChangeDict(
          changeDict, &#x27;uncategorized_skill_id&#x27;);
        topic.removeUncategorizedSkill(newSkillId);
      }, (changeDict, topic) =&gt; {
      // ---- Undo ----
        let newSkillId = this._getParameterFromChangeDict(
          changeDict, &#x27;uncategorized_skill_id&#x27;);
        topic.addUncategorizedSkill(
          newSkillId, skillSummary.getDescription());
      });
  }
}
angular.module(&#x27;oppia&#x27;).factory(
  &#x27;TopicUpdateService&#x27;,
  downgradeInjectable(TopicUpdateService));
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:56,&quot;character&quot;:6,&quot;text&quot;:&quot;entity&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:57,&quot;character&quot;:23,&quot;text&quot;:&quot;params&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:60,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:60,&quot;character&quot;:31,&quot;text&quot;:&quot;params&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:61,&quot;character&quot;:4,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:61,&quot;character&quot;:15,&quot;text&quot;:&quot;cmd&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:66,&quot;character&quot;:38,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:67,&quot;character&quot;:11,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:98,&quot;character&quot;:26,&quot;text&quot;:&quot;newValue&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:98,&quot;character&quot;:36,&quot;text&quot;:&quot;oldValue&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:104,&quot;character&quot;:8,&quot;text&quot;:&quot;new_value&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:104,&quot;character&quot;:29,&quot;text&quot;:&quot;newValue&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:105,&quot;character&quot;:8,&quot;text&quot;:&quot;old_value&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:105,&quot;character&quot;:29,&quot;text&quot;:&quot;oldValue&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:109,&quot;character&quot;:45,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:110,&quot;character&quot;:44,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:113,&quot;character&quot;:39,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:114,&quot;character&quot;:44,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:131,&quot;character&quot;:12,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:151,&quot;character&quot;:12,&quot;text&quot;:&quot;name&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:171,&quot;character&quot;:12,&quot;text&quot;:&quot;metaTagContent&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:193,&quot;character&quot;:12,&quot;text&quot;:&quot;practiceTabIsDisplayed&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:215,&quot;character&quot;:12,&quot;text&quot;:&quot;pageTitleFragmentForWeb&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:236,&quot;character&quot;:12,&quot;text&quot;:&quot;newUrlFragment&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:256,&quot;character&quot;:12,&quot;text&quot;:&quot;thumbnailFilename&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:277,&quot;character&quot;:12,&quot;text&quot;:&quot;thumbnailBgColor&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:298,&quot;character&quot;:12,&quot;text&quot;:&quot;description&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:318,&quot;character&quot;:12,&quot;text&quot;:&quot;languageCode&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:336,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:336,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:338,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:338,&quot;character&quot;:12,&quot;text&quot;:&quot;addSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:339,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:339,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:341,&quot;character&quot;:10,&quot;text&quot;:&quot;subtopicId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:341,&quot;character&quot;:57,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:342,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:342,&quot;character&quot;:12,&quot;text&quot;:&quot;deleteSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:342,&quot;character&quot;:27,&quot;text&quot;:&quot;subtopicId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:360,&quot;character&quot;:24,&quot;text&quot;:&quot;changeList[i] as TopicChange&quot;,&quot;kind&quot;:3},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:369,&quot;character&quot;:10,&quot;text&quot;:&quot;indicesToDelete&quot;,&quot;kind&quot;:2},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:386,&quot;character&quot;:14,&quot;text&quot;:&quot;indicesToDelete&quot;,&quot;kind&quot;:2},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:412,&quot;character&quot;:12,&quot;text&quot;:&quot;indicesToDelete&quot;,&quot;kind&quot;:2},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:427,&quot;character&quot;:12,&quot;text&quot;:&quot;indicesToDelete&quot;,&quot;kind&quot;:2},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:453,&quot;character&quot;:16,&quot;text&quot;:&quot;indicesToDelete&quot;,&quot;kind&quot;:2},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:462,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:462,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:464,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:464,&quot;character&quot;:12,&quot;text&quot;:&quot;deleteSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:465,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:465,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:491,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:491,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:494,&quot;character&quot;:10,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:494,&quot;character&quot;:16,&quot;text&quot;:&quot;removeUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:500,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:500,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:504,&quot;character&quot;:10,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:504,&quot;character&quot;:16,&quot;text&quot;:&quot;addUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:524,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:524,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:527,&quot;character&quot;:13,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:527,&quot;character&quot;:19,&quot;text&quot;:&quot;hasUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:528,&quot;character&quot;:10,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:528,&quot;character&quot;:16,&quot;text&quot;:&quot;addUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:531,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:531,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:535,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:535,&quot;character&quot;:14,&quot;text&quot;:&quot;removeUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:556,&quot;character&quot;:12,&quot;text&quot;:&quot;thumbnailFilename&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:581,&quot;character&quot;:12,&quot;text&quot;:&quot;newUrlFragment&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:607,&quot;character&quot;:12,&quot;text&quot;:&quot;thumbnailBgColor&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:632,&quot;character&quot;:12,&quot;text&quot;:&quot;title&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:689,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:689,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:691,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:691,&quot;character&quot;:14,&quot;text&quot;:&quot;removeAdditionalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:692,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:692,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:694,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:694,&quot;character&quot;:14,&quot;text&quot;:&quot;addAdditionalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:706,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:706,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:708,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:708,&quot;character&quot;:12,&quot;text&quot;:&quot;removeCanonicalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:709,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:709,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:711,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:711,&quot;character&quot;:12,&quot;text&quot;:&quot;addCanonicalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:725,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:725,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:727,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:727,&quot;character&quot;:14,&quot;text&quot;:&quot;rearrangeCanonicalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:728,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:728,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:730,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:730,&quot;character&quot;:14,&quot;text&quot;:&quot;rearrangeCanonicalStory&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:746,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:746,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:748,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:748,&quot;character&quot;:14,&quot;text&quot;:&quot;rearrangeSkillInSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:749,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:749,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:751,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:751,&quot;character&quot;:14,&quot;text&quot;:&quot;rearrangeSkillInSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:764,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:764,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:766,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:766,&quot;character&quot;:12,&quot;text&quot;:&quot;rearrangeSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:767,&quot;character&quot;:8,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:767,&quot;character&quot;:20,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:769,&quot;character&quot;:6,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:769,&quot;character&quot;:12,&quot;text&quot;:&quot;rearrangeSubtopic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:782,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:782,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:784,&quot;character&quot;:12,&quot;text&quot;:&quot;newSkillId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:785,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:786,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:786,&quot;character&quot;:14,&quot;text&quot;:&quot;removeUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:786,&quot;character&quot;:39,&quot;text&quot;:&quot;newSkillId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:787,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:787,&quot;character&quot;:22,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:789,&quot;character&quot;:12,&quot;text&quot;:&quot;newSkillId&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:790,&quot;character&quot;:10,&quot;text&quot;:&quot;changeDict&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:791,&quot;character&quot;:8,&quot;text&quot;:&quot;topic&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:791,&quot;character&quot;:14,&quot;text&quot;:&quot;addUncategorizedSkill&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/domain/topic/topic-update.service.ts&quot;,&quot;line&quot;:792,&quot;character&quot;:10,&quot;text&quot;:&quot;newSkillId&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 17 Jun 2021 20:43:55 GMT</p>
    </body>
  </html>
  