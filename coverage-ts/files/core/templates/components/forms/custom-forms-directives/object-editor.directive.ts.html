
  <!DOCTYPE html>
  <html>
    <head>
      <title>object-editor.directive.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="../../../../../../assets/source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="../../../../../../assets/source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="../../../../../../index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">core/templates/components/forms/custom-forms-directives/object-editor.directive.ts</td><td class="">90.83%</td><td class="">100%</td><td class="">120</td><td class="">109</td><td class="">11</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">// Copyright 2014 The Oppia Authors. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS-IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Directives for the object editors.
 */

// Individual object editor directives are in extensions/objects/templates.

import { CustomSchema } from &#x27;services/schema-default-value.service&#x27;;

interface ObjectEditorCustomScope extends ng.IScope {
  objType?: string;
  ngModelController: {
    $setValidity: (validationErrorKey: string, isValid: boolean) =&gt; void
  };
  schema: CustomSchema;
  initArgs?: Object;
  modalId: symbol;
  getInitArgs?: (() =&gt; Object);
  alwaysEditable?: boolean;
  isEditable?: boolean;
  getAlwaysEditable?: (() =&gt; boolean);
  getIsEditable?: (() =&gt; boolean);
  getSchema?: (() =&gt; CustomSchema);
  updateValue: (unknown) =&gt; void;
  updateValid: (e: Record&lt;string, boolean&gt;) =&gt; void;
  value: unknown;
}

angular.module(&#x27;oppia&#x27;).directive(&#x27;objectEditor&#x27;, [
  &#x27;$compile&#x27;, &#x27;$log&#x27;, &#x27;$rootScope&#x27;, function($compile, $log, $rootScope) {
    return {
      scope: {
        alwaysEditable: &#x27;@&#x27;,
        initArgs: &#x27;=&#x27;,
        isEditable: &#x27;@&#x27;,
        modalId: &#x27;&lt;&#x27;,
        objType: &#x27;@&#x27;,
        getSchema: &#x27;&amp;schema&#x27;,
        value: &#x27;=&#x27;
      },
      link: function(scope: ObjectEditorCustomScope, element) {
        const MIGRATED_EDITORS: string[] = [
          &#x27;algebraic-expression&#x27;,
          &#x27;boolean&#x27;,
          &#x27;code-string&#x27;,
          &#x27;coord-two-dim&#x27;,
          &#x27;custom-osk-letters&#x27;,
          &#x27;drag-and-drop-positive-int&#x27;,
          &#x27;filepath&#x27;,
          &#x27;fraction&#x27;,
          &#x27;graph&#x27;,
          &#x27;html&#x27;,
          &#x27;image-with-regions&#x27;,
          &#x27;int-editor&#x27;,
          &#x27;list-of-sets-of-translatable-html-content-ids&#x27;,
          &#x27;list-of-tabs&#x27;,
          &#x27;list-of-unicode-string&#x27;,
          &#x27;logic-error-category&#x27;,
          &#x27;logic-question&#x27;,
          &#x27;math-equation&#x27;,
          &#x27;math-expression-content&#x27;,
          &#x27;set-of-unicode-string&#x27;,
          &#x27;music-phrase&#x27;,
          &#x27;number-with-units&#x27;,
          &#x27;nonnegative-int&#x27;,
          &#x27;normalized-string&#x27;,
          &#x27;numeric-expression&#x27;,
          &#x27;position-of-terms&#x27;,
          &#x27;positive-int&#x27;,
          &#x27;ratio-expression&#x27;,
          &#x27;real&#x27;,
          &#x27;sanitized-url&#x27;,
          &#x27;set-of-algebraic-identifier&#x27;,
          &#x27;set-of-translatable-html-content-ids&#x27;,
          &#x27;skill-selector&#x27;,
          &#x27;subtitled-html&#x27;,
          &#x27;subtitled-unicode&#x27;,
          &#x27;svg-filename&#x27;,
          &#x27;translatable-html-content-id&#x27;,
          &#x27;translatable-set-of-normalized-string&#x27;,
          &#x27;translatable-set-of-unicode-string&#x27;,
          &#x27;unicode-string&#x27;
        ];
        // Converts a camel-cased string to a lower-case hyphen-separated
        // string.
        var directiveName = scope.objType.replace(
          /([a-z])([A-Z])/g, &#x27;$1-$2&#x27;).toLowerCase();
        scope.getInitArgs = function() {
          return scope.initArgs;
        };
        scope.getAlwaysEditable = function() {
          return scope.alwaysEditable;
        };
        scope.getIsEditable = function() {
          return scope.isEditable;
        };
        scope.updateValue = function(e) {
          scope.value = e;
          $rootScope.$applyAsync();
        };
        scope.updateValid = function(e) {
          if (!scope.ngModelController) {
            return;
          }
          for (const key of Object.keys(e)) {
            scope.ngModelController.$setValidity(key, e[key]);
          }
          scope.$applyAsync();
        };
        if (directiveName) {
          if (MIGRATED_EDITORS.indexOf(directiveName) &gt;= 0) {
            element.html(
              &#x27;&lt;&#x27; + directiveName +
              &#x27;-editor [always-editable]=&quot;alwaysEditable&quot;&#x27; +
              &#x27; [init-args]=&quot;initArgs&quot; [is-editable]=&quot;&#x27; +
              &#x27;isEditable&quot; [schema]=&quot;getSchema()&quot;&#x27; +
              &#x27;[modal-id]=&quot;modalId&quot; (validity-change)=&quot;updateValid($event)&quot;&#x27; +
              &#x27;(value-changed)=&quot;updateValue($event)&quot; [value]=&quot;value&quot;&gt;&lt;/&#x27; +
              directiveName + &#x27;-editor&gt;&#x27; +
              &#x27;&lt;input ng-show=&quot;false&quot; style=&quot;height: 0; width: 0&quot;&#x27; +
              &#x27; ng-model=&quot;value&quot;&gt;&#x27;);
            $compile(element.contents())(scope);
          } else {
            element.html(
              &#x27;&lt;&#x27; + directiveName +
              &#x27;-editor get-always-editable=&quot;getAlwaysEditable()&quot;&#x27; +
              &#x27; get-init-args=&quot;getInitArgs()&quot; get-is-editable=&#x27; +
              &#x27;&quot;getIsEditable()&quot; get-schema=&quot;getSchema()&quot; value=&quot;value&quot;&gt;&lt;/&#x27; +
              directiveName + &#x27;-editor&gt;&#x27;);
            $compile(element.contents())(scope);
          }
        } else {
          $log.error(&#x27;Error in objectEditor: no editor type supplied.&#x27;);
        }
        if (element[0]) {
          scope.ngModelController = angular.element(
            element[0].lastElementChild).controller(&#x27;ngModel&#x27;);
        }
      },
      restrict: &#x27;E&#x27;
    };
  }]);
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:36,&quot;character&quot;:16,&quot;text&quot;:&quot;unknown&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:42,&quot;character&quot;:45,&quot;text&quot;:&quot;$compile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:42,&quot;character&quot;:55,&quot;text&quot;:&quot;$log&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:42,&quot;character&quot;:61,&quot;text&quot;:&quot;$rootScope&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:109,&quot;character&quot;:37,&quot;text&quot;:&quot;e&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:111,&quot;character&quot;:10,&quot;text&quot;:&quot;$rootScope&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:111,&quot;character&quot;:21,&quot;text&quot;:&quot;$applyAsync&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:134,&quot;character&quot;:12,&quot;text&quot;:&quot;$compile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:142,&quot;character&quot;:12,&quot;text&quot;:&quot;$compile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:145,&quot;character&quot;:10,&quot;text&quot;:&quot;$log&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;core/templates/components/forms/custom-forms-directives/object-editor.directive.ts&quot;,&quot;line&quot;:145,&quot;character&quot;:15,&quot;text&quot;:&quot;error&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 17 Jun 2021 20:43:58 GMT</p>
    </body>
  </html>
  